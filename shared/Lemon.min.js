'use strict';var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(a){return void 0!==a};goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};
goog.define=function(a,b){var c=b;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,a)?c=goog.global.CLOSURE_UNCOMPILED_DEFINES[a]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]));goog.exportPath_(a,c)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;
goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(a){if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};goog.constructNamespace_=function(a,b){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(a,b)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if(!goog.isString(a)||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};
goog.module.getInternal_=function(a){if(!COMPILED)return goog.isProvided_(a)?a in goog.loadedModules_?goog.loadedModules_[a]:goog.getObjectByName(a):null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&goog.isDefAndNotNull(goog.getObjectByName(a))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};goog.addDependency=function(a,b,c,d){if(goog.DEPENDENCIES_ENABLED){var e;a=a.replace(/\\/g,"/");for(var f=goog.dependencies_,g=0;e=b[g];g++)f.nameToPath[e]=a,f.pathIsModule[a]=!!d;for(d=0;b=c[d];d++)a in f.requires||(f.requires[a]={}),f.requires[a][b]=!0}};
goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)};goog.require=function(a){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(a);if(goog.isProvided_(a))return goog.isInModuleLoader_()?goog.module.getInternal_(a):null;if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b)return goog.writeScripts_(b),null}a="goog.require could not find: "+a;goog.logToConsole_(a);throw Error(a);}};
goog.basePath="";goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("SCRIPT"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=-1==
d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a,b){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(a,b)&&(goog.dependencies_.written[a]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importModule_=function(a){goog.importScript_("",'goog.retrieveAndExecModule_("'+a+'");')&&(goog.dependencies_.written[a]=!0)},goog.queuedModules_=[],goog.wrapModule_=function(a,b){return goog.LOAD_MODULE_USING_EVAL&&
goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(b+"\n//# sourceURL="+a+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+b+"\n;return exports});\n//# sourceURL="+a+"\n"},goog.loadQueuedModules_=function(){var a=goog.queuedModules_.length;if(0<a){var b=goog.queuedModules_;goog.queuedModules_=[];for(var c=0;c<a;c++)goog.maybeProcessDeferredPath_(b[c])}},goog.maybeProcessDeferredDep_=function(a){goog.isDeferredModule_(a)&&goog.allDepsAreAvailable_(a)&&(a=goog.getPathFromDeps_(a),
goog.maybeProcessDeferredPath_(goog.basePath+a))},goog.isDeferredModule_=function(a){return(a=goog.getPathFromDeps_(a))&&goog.dependencies_.pathIsModule[a]?goog.basePath+a in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(a){if((a=goog.getPathFromDeps_(a))&&a in goog.dependencies_.requires)for(var b in goog.dependencies_.requires[a])if(!goog.isProvided_(b)&&!goog.isDeferredModule_(b))return!1;return!0},goog.maybeProcessDeferredPath_=function(a){if(a in goog.dependencies_.deferred){var b=
goog.dependencies_.deferred[a];delete goog.dependencies_.deferred[a];goog.globalEval(b)}},goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0};var c;if(goog.isFunction(a))c=a.call(goog.global,{});else if(goog.isString(a))c=goog.loadModuleFromSource_.call(goog.global,a);else throw Error("Invalid module definition");var d=goog.moduleLoaderState_.moduleName;if(!goog.isString(d)||!d)throw Error('Invalid module name "'+d+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(d,c):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(c);goog.loadedModules_[d]=c}finally{goog.moduleLoaderState_=b}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptSrcNode_=function(a){goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>')},goog.appendScriptSrcNode_=function(a){var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.src=a;c.defer=!1;c.async=!1;b.head.appendChild(c)},goog.writeScriptTag_=
function(a,b){if(goog.inHtmlDocument_()){var c=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==c.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}var d=goog.IS_OLD_IE_;void 0===b?d?(d=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",c.write('<script type="text/javascript" src="'+a+'"'+d+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(a):
goog.writeScriptSrcNode_(a):c.write('<script type="text/javascript">'+b+"\x3c/script>");return!0}return!1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(a,b){"complete"==a.readyState&&goog.lastNonModuleScriptIndex_==b&&goog.loadQueuedModules_();return!0},goog.writeScripts_=function(a){function b(a){if(!(a in e.written||a in e.visited)){e.visited[a]=!0;if(a in e.requires)for(var f in e.requires[a])if(!goog.isProvided_(f))if(f in e.nameToPath)b(e.nameToPath[f]);else throw Error("Undefined nameToPath for "+
f);a in d||(d[a]=!0,c.push(a))}}var c=[],d={},e=goog.dependencies_;b(a);for(a=0;a<c.length;a++){var f=c[a];goog.dependencies_.written[f]=!0}var g=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(a=0;a<c.length;a++)if(f=c[a])e.pathIsModule[f]?goog.importModule_(goog.basePath+f):goog.importScript_(goog.basePath+f);else throw goog.moduleLoaderState_=g,Error("Undefined script input");goog.moduleLoaderState_=g},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:
null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")};goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);var b=new goog.global.XMLHttpRequest;b.open("get",a,!1);b.send();return b.responseText};
goog.retrieveAndExecModule_=function(a){if(!COMPILED){var b=a;a=goog.normalizePath_(a);var c=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,d=goog.loadFileSync_(a);if(null!=d)d=goog.wrapModule_(a,d),goog.IS_OLD_IE_?(goog.dependencies_.deferred[b]=d,goog.queuedModules_.push(b)):c(a,d);else throw Error("load of "+a+"failed");}};
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(b){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(a);else{var c=goog.global.document,d=c.createElement("SCRIPT");d.type="text/javascript";d.defer=!1;d.appendChild(c.createTextNode(a));
c.body.appendChild(d);c.body.removeChild(d)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};
goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){b&&(a=a.replace(/\{\$([^}]+)}/g,function(a,d){return d in b?b[d]:a}));return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_){for(var e=Array(arguments.length-1),f=1;f<arguments.length;f++)e[f-1]=arguments[f];return d.superClass_.constructor.apply(a,e)}e=Array(arguments.length-2);for(f=2;f<arguments.length;f++)e[f-2]=arguments[f];for(var f=!1,g=a.constructor;g;g=
g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var c=b.constructor,d=b.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,a);a&&goog.inherits(c,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(c.prototype,b);null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return a;var c=function(){var b=a.apply(this,arguments)||this;b[goog.UID_PROPERTY_]=b[goog.UID_PROPERTY_];this.constructor===c&&Object.seal(b);return b};return c}return a};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};goog.tagUnsealableClass=function(a){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";var Lemon={BlendMode:function(a){this.alphaSourceFactor=Lemon.BlendMode.Factor.One;this.alphaDestinationFactor=Lemon.BlendMode.Factor.OneMinusSourceAlpha;this.alphaEquation=Lemon.BlendMode.Equation.Add;this.colorSourceFactor=Lemon.BlendMode.Factor.SourceAlpha;this.colorDestinationFactor=Lemon.BlendMode.Factor.OneMinusSourceAlpha;this.colorEquation=Lemon.BlendMode.Equation.Add;a&&this.setMode(a)}};Lemon.BlendMode.Mode={Alpha:0,Add:1,Multiply:2,None:3};
Lemon.BlendMode.Factor={DestinationAlpha:0,DestinationColor:1,One:2,OneMinusDestinationAlpha:3,OneMinusDestinationColor:4,OneMinusSourceAlpha:5,OneMinusSourceColor:6,SourceAlpha:7,SourceColor:8,Zero:9};Lemon.BlendMode.Equation={Add:0,Subtract:1};
Lemon.BlendMode.prototype.setMode=function(a){switch(a){case Lemon.BlendMode.Mode.Alpha:this.colorSourceFactor=Lemon.BlendMode.Factor.SourceAlpha;this.colorDestinationFactor=Lemon.BlendMode.Factor.OneMinusSourceAlpha;this.colorEquation=Lemon.BlendMode.Equation.Add;this.alphaSourceFactor=Lemon.BlendMode.Factor.One;this.alphaDestinationFactor=Lemon.BlendMode.Factor.OneMinusSourceAlpha;this.alphaEquation=Lemon.BlendMode.Equation.Add;break;case Lemon.BlendMode.Mode.Add:this.colorSourceFactor=Lemon.BlendMode.Factor.SourceAlpha;
this.colorDestinationFactor=Lemon.BlendMode.Factor.One;this.colorEquation=Lemon.BlendMode.Equation.Add;this.alphaDestinationFactor=this.alphaSourceFactor=Lemon.BlendMode.Factor.One;this.alphaEquation=Lemon.BlendMode.Equation.Add;break;case Lemon.BlendMode.Mode.Multiply:this.colorSourceFactor=Lemon.BlendMode.Factor.DestinationColor;this.colorDestinationFactor=Lemon.BlendMode.Factor.One;this.colorEquation=Lemon.BlendMode.Equation.Add;this.alphaSourceFactor=Lemon.BlendMode.Factor.One;this.alphaDestinationFactor=
Lemon.BlendMode.Factor.OneMinusSourceAlpha;this.alphaEquation=Lemon.BlendMode.Equation.Add;break;default:case Lemon.BlendMode.Mode.None:this.colorSourceFactor=Lemon.BlendMode.Factor.One,this.colorDestinationFactor=Lemon.BlendMode.Factor.Zero,this.colorEquation=Lemon.BlendMode.Equation.Add,this.alphaSourceFactor=Lemon.BlendMode.Factor.One,this.alphaDestinationFactor=Lemon.BlendMode.Factor.OneMinusSourceAlpha,this.alphaEquation=Lemon.BlendMode.Equation.Add}};
Lemon.BlendMode.prototype.isEqual=function(a){return this.alphaSourceFactor==a.alphaSourceFactor&&this.alphaDestinationFactor==a.alphaDestinationFactor&&this.alphaEquation==a.alphaEquation&&this.colorSourceFactor==a.colorSourceFactor&&this.colorDestinationFactor==a.colorDestinationFactor&&this.colorEquation==a.colorEquation};Lemon.Color=function(a,b,c,d){this.r=a/255;this.g=b/255;this.b=c/255;this.a=d?d/255:1};Lemon.Color.prototype.set=function(a,b,c,d){this.r=a/255;this.g=b/255;this.b=c/255;this.a=d?d/255:1};Lemon.Color.prototype.isEqual=function(a){return this.r==a.r&&this.g==a.g&&this.b==a.b&&this.a==a.a};Lemon.Private={};Lemon.Private.Context=function(){this.instance=this.domElement=null};Lemon.Private.Context.current=null;Lemon.Private.Context.Type={WebGL:0};Lemon.GetContext=function(){return Lemon.Private.Context.current.instance};
Lemon.Private.Context.prototype.init=function(a,b,c){var d=document.getElementById(c);if(!d)throw"404 - Canvas with the name "+c+" not found.";a==Lemon.Private.Context.Type.WebGL&&(this.domElement=document.createElement("canvas"),this.domElement.width=d.offsetWidth,this.domElement.height=d.offsetHeight,d.appendChild(this.domElement),this.instance=this.domElement.getContext("webgl",{antialias:b.antialiasing||!0}),this.instance.viewportWidth=this.domElement.width,this.instance.viewportHeight=this.domElement.height);
Lemon.Private.Context.current||(Lemon.Private.Context.current=this)};Lemon.Private.Context.prototype.resize=function(a,b){this.domElement&&this.instance&&(this.domElement.width=a,this.domElement.height=b,this.instance.viewportWidth=a,this.instance.viewportHeight=b)};Lemon.Private.Context.prototype.activate=function(){Lemon.Private.Context.current=this};Lemon.Private.Context.prototype.getSize=function(){return[this.domElement.width,this.domElement.height]};Lemon.Private.ContextResource=function(){this.UID=Lemon.Private.ContextResource.globalID++};Lemon.Private.ContextResource.globalID=-1;Lemon.Private.ContextResource.prototype.getUID=function(){return this.UID};Lemon.Image=function(){this.data=new Image;this.height=0;this.pixels=null;this.status=Lemon.Image.Status.Unload;this.width=0};Lemon.Image.Status={Unload:0,Loading:1,Loaded:2};Lemon.Image.prototype.loadFromFile=function(a){var b=this;this.data.onload=function(){b.status=Lemon.Image.Status.Loaded;b.width=b.data.width;b.height=b.data.height;b.pixels=null};this.data.src=a};
Lemon.Image.prototype.create=function(a,b,c){this.pixels=c?c:new Uint8Array(a*b*4);this.data=null;this.width=a;this.height=b;this.status=Lemon.Image.Status.Loaded};Lemon.Image.prototype.getSize=function(){return[this.width,this.height]};Lemon.Image.prototype.getData=function(){return this.data||this.pixels};Lemon.Image.prototype.isReady=function(){return this.status==Lemon.Image.Status.Loaded};Lemon.Loaders={};Lemon.Loaders.FileLoader=function(){};Lemon.Loaders.FileLoader.load=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4!==d.readyState||200!==d.status&&0!==d.status||b(!0,d.responseText,c)};d.open("GET",a,!0);d.send()};Lemon.WebGLObjects={};Lemon.WebGLObjects.BufferData=function(){this.indexBuffer=null;this.vertexBuffers=[];this.vao=null};Lemon.WebGLObjects.Instances=function(){this.buffers=[];this.frameBuffers=[];this.programs=[];this.textures=[]};Lemon.StateBlock=function(){this.blendMode=new Lemon.BlendMode;this.depthFunction=Lemon.DepthFunction.Less;this.depthTest=this.depthWrite=!0;this.drawingMode=Lemon.DrawingMode.Triangles;this.faceCulling=Lemon.FaceCulling.Back;this.stencilFunction=Lemon.StencilFunction.Less;this.stencilReference=0;this.stencilMask=255;this.stencilTest=!1;this.stencilWrite=255;this.stencilSuccess=this.stencilDepthTestFail=this.stencilTestFail=Lemon.StencilOperation.Keep};
Lemon.DepthFunction={Never:0,Less:1,Equal:2,LessEqual:3,Greater:4,NotEqual:5,GreaterEqual:6,Always:7};Lemon.DrawingMode={Points:0,Lines:1,LinesStrip:2,LinesLoop:3,Triangles:4,TrianglesStrip:5,TrianglesFan:6};Lemon.FaceCulling={Back:0,Front:1,None:2};Lemon.StencilFunction={Never:0,Less:1,Equal:2,LessEqual:3,Greater:4,NotEqual:5,GreaterEqual:6,Always:7};Lemon.StencilOperation={Keep:0,Zero:1,Replace:2,Increment:3,Decrement:4,Invert:5,IncrementWrap:6,DecrementWrap:7};
Lemon.StateBlock.prototype.isEqual=function(a){return this.blendMode.isEqual(a.blendMode)&&this.depthFunction==a.depthFunction&&this.depthWrite==a.depthWrite&&this.depthTest==a.depthTest&&this.stencilFunction==a.stencilFunction&&this.stencilReference==a.stencilReference&&this.stencilMask==a.stencilMask&&this.stencilTest==a.stencilTest&&this.stencilWrite==a.stencilWrite&&this.stencilTestFail==a.stencilTestFail&&this.stencilDepthTestFail==a.stencilDepthTestFail&&this.stencilSuccess==a.stencilSuccess};Lemon.TextureCube=function(){Lemon.Private.ContextResource.call(this);this.images=[]};goog.inherits(Lemon.TextureCube,Lemon.Private.ContextResource);Lemon.TextureCube.Face={Up:0,Down:1,Left:2,Right:3,Back:4,Front:5};Lemon.TextureCube.prototype.loadFromFiles=function(a){for(var b in a){var c=new Lemon.Image;c.loadFromFile(a[b]);this.images[b]=c}};Lemon.TextureCube.prototype.getImages=function(){return this.images};
Lemon.TextureCube.prototype.isReady=function(){if(0===this.images.length)return!1;for(var a=0;a<this.images.length;a++)if(!this.images[a].isReady())return!1;return!0};Lemon.Private.TextureInterface=function(){Lemon.Private.ContextResource.call(this);this.ready=!1;this.mipmap=!0};goog.inherits(Lemon.Private.TextureInterface,Lemon.Private.ContextResource);Lemon.Private.TextureInterface.prototype.isReady=function(){return this.ready};Lemon.Private.TextureInterface.prototype.isMipmaped=function(){return this.mipmap};Lemon.Private.TextureInterface.prototype.isRepeated=function(){return!1};Lemon.Private.TextureInterface.prototype.isSmoothed=function(){return!1};
Lemon.Private.TextureInterface.prototype.useMipmap=function(a){this.mipmap=a};Lemon.Texture=function(){Lemon.Private.TextureInterface.call(this);this.image=null;this.smooth=this.repeat=!0};goog.inherits(Lemon.Texture,Lemon.Private.TextureInterface);Lemon.Texture.prototype.loadFromFile=function(a){this.image=new Lemon.Image;this.image.loadFromFile(a)};Lemon.Texture.prototype.loadFromImage=function(a){this.image=a};Lemon.Texture.prototype.setRepeated=function(a){this.repeat=a};Lemon.Texture.prototype.setSmooth=function(a){this.smooth=a};Lemon.Texture.prototype.getImage=function(){return this.image};
Lemon.Texture.prototype.isReady=function(){if(!this.image)return!1;var a=this.image.getSize();return 0===a[0]||0===a[1]?!1:!0};Lemon.Texture.prototype.isRepeated=function(){return this.repeat};Lemon.Texture.prototype.isSmoothed=function(){return this.smooth};Lemon.TextureVideo=function(){Lemon.Private.TextureInterface.call(this);this.data=document.createElement("video")};goog.inherits(Lemon.TextureVideo,Lemon.Private.TextureInterface);Lemon.TextureVideo.prototype.loadFromFile=function(a){var b=this;this.data.addEventListener("canplaythrough",function(){b.ready=!0},!0);this.data.preload="auto";this.data.src=a};Lemon.TextureVideo.prototype.pause=function(){this.data.pause()};Lemon.TextureVideo.prototype.play=function(){this.data.play()};
Lemon.TextureVideo.prototype.getDuration=function(){return this.data.duration};Lemon.TextureVideo.prototype.getVideoData=function(){return this.data};Lemon.Type={Float:0,Int:1,Bool:2,Matrix:3,Texture2D:4,TextureCube:5,Byte:6,u_Byte:7,Short:8,u_Short:9,u_Int:10};Lemon.Program=function(){Lemon.Private.ContextResource.call(this);this.attributes=[];this.sources=[null,null];this.uniforms=[]};goog.inherits(Lemon.Program,Lemon.Private.ContextResource);Lemon.Program.Element=function(a,b,c,d){this.location=a;this.name=b;this.type=c;this.size=d};Lemon.Program.prototype.loadFromFiles=function(a,b){var c=this;Lemon.Loaders.FileLoader.load(a,function(a,b){c.sources[0]=b});Lemon.Loaders.FileLoader.load(b,function(a,b){c.sources[1]=b})};
Lemon.Program.prototype.loadFromData=function(a,b){this.sources[0]=a;this.sources[1]=b};Lemon.Program.prototype.getAttributes=function(){return this.attributes};Lemon.Program.prototype.getSources=function(){return this.sources};Lemon.Program.prototype.getUniform=function(a){return this.uniforms[a]||null};Lemon.Program.prototype.getUniforms=function(){return this.uniforms};Lemon.Program.prototype.isReady=function(){return 2===this.sources.length&&null!==this.sources[0]&&null!==this.sources[1]};Lemon.ProgramLibrary=function(){};Lemon.ProgramLibrary.cache=[];Lemon.ProgramLibrary.chunks=[];Lemon.ProgramLibrary.folderPath="../shaders/";Lemon.ProgramLibrary.programs=[];Lemon.ProgramLibrary.Target={Vertex:0,Fragment:1};Lemon.ProgramLibrary.get=function(a){var b=Lemon.ProgramLibrary.programs[a];b||(b=new Lemon.Program,Lemon.ProgramLibrary.programs[a]=b);return b};
Lemon.ProgramLibrary.load=function(a,b,c,d){var e=Lemon.ProgramLibrary.get(a),f=/include\[([^\]]*)\]/g;Lemon.ProgramLibrary.cache[a]={data:null,ready:!1,sources:[]};var g=function(a,b,c){Lemon.ProgramLibrary.chunks[c].data=b;Lemon.ProgramLibrary.chunks[c].ready=!0;Lemon.ProgramLibrary.tryUpdateWaitingPrograms()},h=function(b,c,d){c=Lemon.ProgramLibrary.programs[a];var e=c.getSources(),h=d.match(f);if(h){for(var r=h.length,t=0;t<h.length;t++){var p=h[t],p=p.substring(p.lastIndexOf("[")+1,p.lastIndexOf("]"));
Lemon.ProgramLibrary.chunks[p]&&Lemon.ProgramLibrary.chunks[p].ready?r--:Lemon.ProgramLibrary.chunks[p]||(Lemon.ProgramLibrary.chunks[p]={data:"",ready:!1},Lemon.Loaders.FileLoader.load(Lemon.ProgramLibrary.folderPath+p+"?"+(new Date).getTime(),g,p))}d=Lemon.ProgramLibrary.replaceChunks(d);0===r&&Lemon.ProgramLibrary.fillProgram(e,c,a,b,d||"")}else Lemon.ProgramLibrary.fillProgram(e,c,a,b,d)};Lemon.Loaders.FileLoader.load(Lemon.ProgramLibrary.folderPath+b+"?"+(new Date).getTime(),function(b,c){c=
Lemon.ProgramLibrary.addDefines(c,d||[]);Lemon.ProgramLibrary.cache[a].sources[0]=c;h(Lemon.ProgramLibrary.Target.Vertex,a,c)});Lemon.Loaders.FileLoader.load(Lemon.ProgramLibrary.folderPath+c+"?"+(new Date).getTime(),function(b,c){c=Lemon.ProgramLibrary.addDefines(c,d||[]);Lemon.ProgramLibrary.cache[a].sources[1]=c;h(Lemon.ProgramLibrary.Target.Fragment,a,c)});return e};
Lemon.ProgramLibrary.fillProgram=function(a,b,c,d,e){d==Lemon.ProgramLibrary.Target.Vertex?b.loadFromData(e,a[1]):b.loadFromData(a[0],e);b.isReady()&&delete Lemon.ProgramLibrary.cache[c]};
Lemon.ProgramLibrary.tryUpdateWaitingPrograms=function(){for(var a in Lemon.ProgramLibrary.programs)if(!Lemon.ProgramLibrary.programs[a].isReady())for(var b=Lemon.ProgramLibrary.programs[a].getSources(),c=0;2>c;c++)if(!b[c]){var d=Lemon.ProgramLibrary.replaceChunks(Lemon.ProgramLibrary.cache[a].sources[c]);d&&Lemon.ProgramLibrary.fillProgram(b,Lemon.ProgramLibrary.programs[a],a,0===c?Lemon.ProgramLibrary.Target.Vertex:Lemon.ProgramLibrary.Target.Fragment,d)}};
Lemon.ProgramLibrary.replaceChunks=function(a){for(var b=/include\[([^\]]*)\]/;b.test(a);){var c=a.match(b),d=c[0].substring(c[0].lastIndexOf("[")+1,c[0].lastIndexOf("]"));if(!Lemon.ProgramLibrary.chunks[d]||!Lemon.ProgramLibrary.chunks[d].ready)return null;a=a.replace(c[0],Lemon.ProgramLibrary.chunks[d].data||"")}return a};Lemon.ProgramLibrary.addDefines=function(a,b){if(!b)return a;for(var c="",d=0;d<b.length;d++)c+="#define "+b[d]+"\n";return c+a};Lemon.PassParameter=function(a,b,c){this.name=a;this.type=b;this.value=c};Lemon.Pass=function(){Lemon.StateBlock.call(this);this.parameters=[]};goog.inherits(Lemon.Pass,Lemon.StateBlock);Lemon.Pass.prototype.add=function(a,b,c){for(var d=0;d<this.parameters.length;d++)if(this.parameters[d].name==a){this.parameters[d].value=c;this.parameters[d].type=b;return}this.parameters.push(new Lemon.PassParameter(a,b,c))};
Lemon.Pass.prototype.set=function(a,b){for(var c=0;c<this.parameters.length;c++)if(this.parameters[c].name==a){this.parameters[c].value=b;break}};Lemon.Pass.prototype.getParameters=function(){return this.parameters};Lemon.Material=function(){this.activeTechnique=0;this.techniques=[];this.createTechnique()};Lemon.Material.create=function(a){var b=new Lemon.Material,c=b.createPass();"default"==a&&(c.add("material.ambient",Lemon.Type.Float,[0,0,0]),c.add("material.diffuse",Lemon.Type.Float,[.55,.55,.55]),c.add("material.specular",Lemon.Type.Float,[.7,.7,.7]),c.add("material.shininess",Lemon.Type.Float,38.4));return b};
Lemon.Material.prototype.createPass=function(a){var b=new Lemon.Pass;this.techniques[a||0].push(b);return b};Lemon.Material.prototype.createTechnique=function(){this.techniques.push([]);return this.techniques.length-1};Lemon.Material.prototype.setActiveTechnique=function(a){this.activeTechnique=a};Lemon.Material.prototype.getActiveTechnique=function(){return this.activeTechnique};Lemon.Material.prototype.getPass=function(a,b){return a>=this.techniques.length?null:this.techniques[a][b]||null};
Lemon.Material.prototype.getPassCount=function(a){return a>=this.techniques.length?0:this.techniques[a].length};Lemon.VertexElement=function(a,b,c,d,e){this.count=d||0;this.normalize=e||!1;this.offset=0;this.stream=b;this.stride=0;this.type=c;this.usage=a};Lemon.VertexElement.StreamType={Static:0,Dynamic:1,Stream:2};Lemon.VertexElement.Type={Byte:0,Float:1,Int:2,Short:3};Lemon.VertexElement.Usage={Position:0,Color:1,UVS:2,Normal:3,Tangent:4};Lemon.VertexFormat=function(){this.elements=[];this.streamType=[];this.streamStride=[];this.streamNeedUpdate=[];this.indicesNeedUpdate=!0};
Lemon.VertexFormat.prototype.add=function(a){this.elements.push(a);this.compute()};Lemon.VertexFormat.prototype.set=function(a){this.elements=a;this.compute()};Lemon.VertexFormat.prototype.setStreamType=function(a,b){this.streamType[a]=b};
Lemon.VertexFormat.prototype.compute=function(){var a=0,b=0,b=0;this.elements.sort(function(a,b){return a.stream<b.stream?-1:a.stream>b.stream?1:0});for(var c=0;c<this.elements.length;c++){b!=this.elements[c].stream&&(this.streamStride[b]=a,a=0);switch(this.elements[c].type){case Lemon.VertexElement.Type.Float:case Lemon.VertexElement.Type.Int:b=4;break;case Lemon.VertexElement.Type.Short:b=2;break;case Lemon.VertexElement.Type.Byte:b=1;break;default:b=1}this.elements[c].offset=a;b*=this.elements[c].count;
a+=b;b=this.elements[c].stream}this.streamStride[b]=a};Lemon.VertexFormat.prototype.setIndicesAsWaitingUpdate=function(a){this.indicesNeedUpdate=a};Lemon.VertexFormat.prototype.setStreamAsWaitingUpdate=function(a,b){for(var c=0;c<this.elements.length;c++)this.elements[c].usage==a&&(this.streamNeedUpdate[this.elements[c].stream]=b)};Lemon.VertexFormat.prototype.getElements=function(){return this.elements};Lemon.VertexFormat.prototype.getStreamStride=function(a){return this.streamStride[a]||0};
Lemon.VertexFormat.prototype.getStreamType=function(a){return this.streamType[a]||Lemon.VertexElement.StreamType.Stream};Lemon.VertexFormat.prototype.isIndicesWaitingUpdate=function(){return this.indicesNeedUpdate};Lemon.VertexFormat.prototype.isStreamWaitingUpdate=function(a){return this.streamNeedUpdate[a]};Lemon.Geometry=function(){Lemon.Private.ContextResource.call(this);this.vertexFormat=this.uvs=this.positions=this.normals=this.indices=this.colors=null};goog.inherits(Lemon.Geometry,Lemon.Private.ContextResource);Lemon.Geometry.prototype.setColors=function(a){this.colors=new Float32Array(a);this.vertexFormat&&this.vertexFormat.setStreamAsWaitingUpdate(Lemon.VertexElement.Usage.Color,!0)};Lemon.Geometry.prototype.setIndices=function(a){this.indices=new Uint16Array(a);this.vertexFormat&&this.vertexFormat.setIndicesAsWaitingUpdate(!0)};
Lemon.Geometry.prototype.setNormals=function(a){this.normals=new Float32Array(a);this.vertexFormat&&this.vertexFormat.setStreamAsWaitingUpdate(Lemon.VertexElement.Usage.Normal,!0)};Lemon.Geometry.prototype.setPositions=function(a){this.positions=new Float32Array(a);this.vertexFormat&&this.vertexFormat.setStreamAsWaitingUpdate(Lemon.VertexElement.Usage.Position,!0)};
Lemon.Geometry.prototype.setTextureUVs=function(a){this.uvs=new Float32Array(a);this.vertexFormat&&this.vertexFormat.setStreamAsWaitingUpdate(Lemon.VertexElement.Usage.UVS,!0)};Lemon.Geometry.prototype.setVertexFormat=function(a){this.vertexFormat=a};Lemon.Geometry.prototype.getVertexFormat=function(){return this.vertexFormat};Lemon.Geometry.prototype.getIndexCount=function(){return this.indices.length};Lemon.Geometry.prototype.getIndices=function(){return this.indices};
Lemon.Geometry.prototype.getVerticesColors=function(){return this.colors};Lemon.Geometry.prototype.getVerticesPositions=function(){return this.positions};Lemon.Geometry.prototype.getVerticesNormals=function(){return this.normals};Lemon.Geometry.prototype.getVerticesUVs=function(){return this.uvs};
Lemon.Geometry.createCube=function(a,b,c){var d=new Lemon.Geometry,e=new Lemon.VertexFormat;e.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Position,0,Lemon.VertexElement.Type.Float,3,!1));e.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Color,2,Lemon.VertexElement.Type.Float,4,!1));e.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.UVS,1,Lemon.VertexElement.Type.Float,2,!1));e.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Normal,3,Lemon.VertexElement.Type.Float,3,!1));
d.setVertexFormat(e);a=new Float32Array([-a,-b,c,a,-b,c,a,b,c,-a,b,c,-a,-b,-c,-a,b,-c,a,b,-c,a,-b,-c,-a,b,-c,-a,b,c,a,b,c,a,b,-c,-a,-b,-c,a,-b,-c,a,-b,c,-a,-b,c,a,-b,-c,a,b,-c,a,b,c,a,-b,c,-a,-b,-c,-a,-b,c,-a,b,c,-a,b,-c]);d.setPositions(a);a=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);d.setColors(a);a=new Float32Array([0,0,1,0,1,1,
0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]);d.setTextureUVs(a);a=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);d.setNormals(a);a=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);d.setIndices(a);return d};
Lemon.Geometry.createRectangle=function(a,b){var c=new Lemon.Geometry,d=new Lemon.VertexFormat;d.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Position,0,Lemon.VertexElement.Type.Float,3,!1));d.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Color,1,Lemon.VertexElement.Type.Float,4,!1));d.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.UVS,2,Lemon.VertexElement.Type.Float,2,!1));d.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Normal,3,Lemon.VertexElement.Type.Float,3,!1));
c.setVertexFormat(d);d=new Float32Array([-a,-b,0,-a,b,0,a,-b,0,a,b,0]);c.setPositions(d);d=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);c.setColors(d);d=new Float32Array([0,1,0,0,1,1,1,0]);c.setTextureUVs(d);d=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);c.setNormals(d);c.setIndices(new Uint16Array([0,2,1,3]));return c};goog.debug={};goog.debug.Error=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a));this.reportErrorToServer=!0};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.dom={};goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.string={};goog.string.DETECT_DOUBLE_ESCAPING=!1;goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1;goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};
goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};goog.string.caseInsensitiveEquals=function(a,b){return a.toLowerCase()==b.toLowerCase()};goog.string.subs=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};
goog.string.isEmptyOrWhitespace=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptyString=function(a){return 0==a.length};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(a){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(a))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};
goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};
goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};
goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(a,b){var c=String(a).toLowerCase(),d=String(b).toLowerCase();return c<d?-1:c==d?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;
goog.string.numerateCompare=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=a.toLowerCase().match(goog.string.numerateCompareRegExp_),d=b.toLowerCase().match(goog.string.numerateCompareRegExp_),e=Math.min(c.length,d.length),f=0;f<e;f++){var g=c[f],h=d[f];if(g!=h)return c=parseInt(g,10),!isNaN(c)&&(d=parseInt(h,10),!isNaN(d)&&c-d)?c-d:g<h?-1:1}return c.length!=d.length?c.length-d.length:a<b?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};
goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)a=a.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(a=a.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.AMP_RE_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.LT_RE_,
"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.GT_RE_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.QUOT_RE_,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(goog.string.NULL_RE_,"&#0;"));goog.string.DETECT_DOUBLE_ESCAPING&&-1!=a.indexOf("e")&&(a=a.replace(goog.string.E_RE_,"&#101;"))}return a};goog.string.AMP_RE_=/&/g;goog.string.LT_RE_=/</g;goog.string.GT_RE_=/>/g;goog.string.QUOT_RE_=/"/g;
goog.string.SINGLE_QUOTE_RE_=/'/g;goog.string.NULL_RE_=/\x00/g;goog.string.E_RE_=/e/g;goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesWithDocument=function(a,b){return goog.string.contains(a,"&")?goog.string.unescapeEntitiesUsingDom_(a,b):a};
goog.string.unescapeEntitiesUsingDom_=function(a,b){var c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},d;d=b?b.createElement("div"):goog.global.document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,b){var g=c[a];if(g)return g;if("#"==b.charAt(0)){var h=Number("0"+b.substr(1));isNaN(h)||(g=String.fromCharCode(h))}g||(d.innerHTML=a+" ",g=d.firstChild.nodeValue.slice(0,-1));return c[a]=g})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if("#"==c.charAt(0)){var d=Number("0"+c.substr(1));if(!isNaN(d))return String.fromCharCode(d)}return a}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.preserveSpaces=function(a){return a.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,d){c&&(a=goog.string.unescapeEntities(a));if(d&&a.length>b){d>b&&(d=b);var e=a.length-d;a=a.substring(0,b-d)+"..."+a.substring(e)}else a.length>b&&(d=Math.floor(b/2),e=a.length-d,a=a.substring(0,d+b%2)+"..."+a.substring(e));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[d]||(31<e&&127>e?d:goog.string.escapeChar(d))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a,c=a.charCodeAt(0);if(31<c&&127>c)b=a;else{if(256>c){if(b="\\x",16>c||256<c)b+="0"}else b="\\u",4096>c&&(b+="0");b+=c.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=b};goog.string.contains=function(a,b){return-1!=a.indexOf(b)};
goog.string.caseInsensitiveContains=function(a,b){return goog.string.contains(a.toLowerCase(),b.toLowerCase())};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var d=a;0<=b&&b<a.length&&0<c&&(d=a.substr(0,b)+a.substr(b+c,a.length-b-c));return d};goog.string.remove=function(a,b){var c=new RegExp(goog.string.regExpEscape(b),"");return a.replace(c,"")};
goog.string.removeAll=function(a,b){var c=new RegExp(goog.string.regExpEscape(b),"g");return a.replace(c,"")};goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return Array(b+1).join(a)};goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};
goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){for(var c=0,d=goog.string.trim(String(a)).split("."),e=goog.string.trim(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&g<f;g++){var h=d[g]||"",k=e[g]||"",l=/(\d*)(\D*)/g,n=/(\d*)(\D*)/g;do{var m=l.exec(h)||["","",""],q=n.exec(k)||["","",""];if(0==m[0].length&&0==q[0].length)break;var c=0==m[1].length?0:parseInt(m[1],10),r=0==q[1].length?0:parseInt(q[1],10),c=goog.string.compareElements_(c,r)||goog.string.compareElements_(0==m[2].length,0==q[2].length)||
goog.string.compareElements_(m[2],q[2])}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=goog.string.HASHCODE_MAX_;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmptyOrWhitespace(a)?NaN:b};goog.string.isLowerCamelCase=function(a){return/^[a-z]+([A-Z][a-z]*)*$/.test(a)};goog.string.isUpperCamelCase=function(a){return/^([A-Z][a-z]*)+$/.test(a)};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};
goog.string.toTitleCase=function(a,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(new RegExp("(^"+(c?"|["+c+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()})};goog.string.capitalize=function(a){return String(a.charAt(0)).toUpperCase()+String(a.substr(1)).toLowerCase()};goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};
goog.string.splitLimit=function(a,b,c){a=a.split(b);for(var d=[];0<c&&a.length;)d.push(a.shift()),c--;a.length&&d.push(a.join(b));return d};goog.string.editDistance=function(a,b){var c=[],d=[];if(a==b)return 0;if(!a.length||!b.length)return Math.max(a.length,b.length);for(var e=0;e<b.length+1;e++)c[e]=e;for(e=0;e<a.length;e++){d[0]=e+1;for(var f=0;f<b.length;f++)d[f+1]=Math.min(d[f]+1,c[f+1]+1,c[f]+(a[e]!=b[f]));for(f=0;f<c.length;f++)c[f]=d[f]}return d[b.length]};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(a){throw a;};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;
goog.asserts.doAssertFailure_=function(a,b,c,d){var e="Assertion failed";if(c)var e=e+(": "+c),f=d;else a&&(e+=": "+a,f=b);a=new goog.asserts.AssertionError(""+e,f||[]);goog.asserts.errorHandler_(a)};goog.asserts.setErrorHandler=function(a){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=a)};goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.fail=function(a,b){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertElement=function(a,b,c){!goog.asserts.ENABLE_ASSERTS||goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,d){!goog.asserts.ENABLE_ASSERTS||a instanceof b||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(b),goog.asserts.getType_(a)],c,Array.prototype.slice.call(arguments,3));return a};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var a in Object.prototype)goog.asserts.fail(a+" should not be enumerable in Object.prototype.")};
goog.asserts.getType_=function(a){return a instanceof Function?a.displayName||a.name||"unknown type name":a instanceof Object?a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a):null===a?"null":typeof a};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.ASSUME_NATIVE_FUNCTIONS=!1;goog.array.peek=function(a){return a[a.length-1]};goog.array.last=goog.array.peek;goog.array.ARRAY_PROTOTYPE_=Array.prototype;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.indexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return goog.isString(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.lastIndexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return goog.isString(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.forEach)?function(a,b,c){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};goog.array.forEachRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;--d)d in e&&b.call(c,e[d],d,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.filter)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=goog.isString(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.map)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=goog.isString(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};
goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.reduce)?function(a,b,c,d){goog.asserts.assert(null!=a.length);d&&(b=goog.bind(b,d));return goog.array.ARRAY_PROTOTYPE_.reduce.call(a,b,c)}:function(a,b,c,d){var e=c;goog.array.forEach(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.reduceRight)?function(a,b,c,d){goog.asserts.assert(null!=a.length);d&&(b=goog.bind(b,d));return goog.array.ARRAY_PROTOTYPE_.reduceRight.call(a,b,c)}:function(a,b,c,d){var e=c;goog.array.forEachRight(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.some)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.every)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};goog.array.count=function(a,b,c){var d=0;goog.array.forEach(a,function(a,f,g){b.call(c,a,f,g)&&++d},c);return d};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;d--)if(d in e&&b.call(c,e[d],d,a))return d;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var d;2==arguments.length||0>(d=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,d)};goog.array.remove=function(a,b){var c=goog.array.indexOf(a,b),d;(d=0<=c)&&goog.array.removeAt(a,c);return d};
goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.removeAllIf=function(a,b,c){var d=0;goog.array.forEachRight(a,function(e,f){b.call(c,e,f,a)&&goog.array.removeAt(a,f)&&d++});return d};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};
goog.array.join=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(goog.isArrayLike(d)){var e=a.length||0,f=d.length||0;a.length=e+f;for(var g=0;g<f;g++)a[e+g]=d[g]}else a.push(d)}};
goog.array.splice=function(a,b,c,d){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?goog.array.ARRAY_PROTOTYPE_.slice.call(a,b):goog.array.ARRAY_PROTOTYPE_.slice.call(a,b,c)};
goog.array.removeDuplicates=function(a,b,c){b=b||a;var d=function(a){return goog.isObject(a)?"o"+goog.getUid(a):(typeof a).charAt(0)+a};c=c||d;for(var d={},e=0,f=0;f<a.length;){var g=a[f++],h=c(g);Object.prototype.hasOwnProperty.call(d,h)||(d[h]=!0,b[e++]=g)}b.length=e};goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};
goog.array.binarySearch_=function(a,b,c,d,e){for(var f=0,g=a.length,h;f<g;){var k=f+g>>1,l;l=c?b.call(e,a[k],k,a):b(d,a[k]);0<l?f=k+1:(g=k,h=!l)}return h?f:~f};goog.array.sort=function(a,b){a.sort(b||goog.array.defaultCompare)};goog.array.stableSort=function(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||goog.array.defaultCompare;goog.array.sort(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value};
goog.array.sortByKey=function(a,b,c){var d=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return d(b(a),b(c))})};goog.array.sortObjectsByKey=function(a,b,c){goog.array.sortByKey(a,function(a){return a[b]},c)};goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var d=1;d<a.length;d++){var e=b(a[d-1],a[d]);if(0<e||0==e&&c)return!1}return!0};
goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var d=a.length;c=c||goog.array.defaultCompareEquality;for(var e=0;e<d;e++)if(!c(a[e],b[e]))return!1;return!0};goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var d=Math.min(a.length,b.length),e=0;e<d;e++){var f=c(a[e],b[e]);if(0!=f)return f}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};
goog.array.inverseDefaultCompare=function(a,b){return-goog.array.defaultCompare(a,b)};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};
goog.array.bucket=function(a,b,c){for(var d={},e=0;e<a.length;e++){var f=a[e],g=b.call(c,f,e,a);goog.isDef(g)&&(d[g]||(d[g]=[])).push(f)}return d};goog.array.toObject=function(a,b,c){var d={};goog.array.forEach(a,function(e,f){d[b.call(c,e,f,a)]=e});return d};goog.array.range=function(a,b,c){var d=[],e=0,f=a;c=c||1;void 0!==b&&(e=a,f=b);if(0>c*(f-e))return[];if(0<c)for(a=e;a<f;a+=c)d.push(a);else for(a=e;a>f;a+=c)d.push(a);return d};
goog.array.repeat=function(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];if(goog.isArray(d))for(var e=0;e<d.length;e+=8192)for(var f=goog.array.slice(d,e,e+8192),f=goog.array.flatten.apply(null,f),g=0;g<f.length;g++)b.push(f[g]);else b.push(d)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?goog.array.ARRAY_PROTOTYPE_.unshift.apply(a,a.splice(-b,b)):0>b&&goog.array.ARRAY_PROTOTYPE_.push.apply(a,a.splice(0,-b)));return a};goog.array.moveItem=function(a,b,c){goog.asserts.assert(0<=b&&b<a.length);goog.asserts.assert(0<=c&&c<a.length);b=goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1);goog.array.ARRAY_PROTOTYPE_.splice.call(a,c,0,b[0])};
goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=0;;c++){for(var d=[],e=0;e<arguments.length;e++){var f=arguments[e];if(c>=f.length)return b;d.push(f[c])}b.push(d)}};goog.array.shuffle=function(a,b){for(var c=b||Math.random,d=a.length-1;0<d;d--){var e=Math.floor(c()*(d+1)),f=a[d];a[d]=a[e];a[e]=f}};goog.array.copyByIndex=function(a,b){var c=[];goog.array.forEach(b,function(b){c.push(a[b])});return c};goog.math={};goog.math.randomInt=function(a){return Math.floor(Math.random()*a)};goog.math.uniformRandom=function(a,b){return a+Math.random()*(b-a)};goog.math.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};goog.math.modulo=function(a,b){var c=a%b;return 0>c*b?c+b:c};goog.math.lerp=function(a,b,c){return a+c*(b-a)};goog.math.nearlyEquals=function(a,b,c){return Math.abs(a-b)<=(c||1E-6)};goog.math.standardAngle=function(a){return goog.math.modulo(a,360)};
goog.math.standardAngleInRadians=function(a){return goog.math.modulo(a,2*Math.PI)};goog.math.toRadians=function(a){return a*Math.PI/180};goog.math.toDegrees=function(a){return 180*a/Math.PI};goog.math.angleDx=function(a,b){return b*Math.cos(goog.math.toRadians(a))};goog.math.angleDy=function(a,b){return b*Math.sin(goog.math.toRadians(a))};goog.math.angle=function(a,b,c,d){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(d-b,c-a)))};
goog.math.angleDifference=function(a,b){var c=goog.math.standardAngle(b)-goog.math.standardAngle(a);180<c?c-=360:-180>=c&&(c=360+c);return c};goog.math.sign=Math.sign||function(a){return 0<a?1:0>a?-1:a};
goog.math.longestCommonSubsequence=function(a,b,c,d){c=c||function(a,b){return a==b};d=d||function(b,c){return a[b]};for(var e=a.length,f=b.length,g=[],h=0;h<e+1;h++)g[h]=[],g[h][0]=0;for(var k=0;k<f+1;k++)g[0][k]=0;for(h=1;h<=e;h++)for(k=1;k<=f;k++)c(a[h-1],b[k-1])?g[h][k]=g[h-1][k-1]+1:g[h][k]=Math.max(g[h-1][k],g[h][k-1]);for(var l=[],h=e,k=f;0<h&&0<k;)c(a[h-1],b[k-1])?(l.unshift(d(h-1,k-1)),h--,k--):g[h-1][k]>g[h][k-1]?h--:k--;return l};
goog.math.sum=function(a){return goog.array.reduce(arguments,function(a,c){return a+c},0)};goog.math.average=function(a){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(a){var b=arguments.length;if(2>b)return 0;var c=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(a){return Math.pow(a-c,2)}))/(b-1)};goog.math.standardDeviation=function(a){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};
goog.math.isInt=function(a){return isFinite(a)&&0==a%1};goog.math.isFiniteNumber=function(a){return isFinite(a)&&!isNaN(a)};goog.math.isNegativeZero=function(a){return 0==a&&0>1/a};goog.math.log10Floor=function(a){if(0<a){var b=Math.round(Math.log(a)*Math.LOG10E);return b-(parseFloat("1e"+b)>a)}return 0==a?-Infinity:NaN};goog.math.safeFloor=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.floor(a+(b||2E-15))};
goog.math.safeCeil=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.ceil(a-(b||2E-15))};goog.vec={};goog.vec.Float32Array=function(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0};goog.vec.Float32Array.BYTES_PER_ELEMENT=4;goog.vec.Float32Array.prototype.BYTES_PER_ELEMENT=4;goog.vec.Float32Array.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};goog.vec.Float32Array.prototype.toString=Array.prototype.join;
"undefined"==typeof Float32Array&&(goog.exportProperty(goog.vec.Float32Array,"BYTES_PER_ELEMENT",goog.vec.Float32Array.BYTES_PER_ELEMENT),goog.exportProperty(goog.vec.Float32Array.prototype,"BYTES_PER_ELEMENT",goog.vec.Float32Array.prototype.BYTES_PER_ELEMENT),goog.exportProperty(goog.vec.Float32Array.prototype,"set",goog.vec.Float32Array.prototype.set),goog.exportProperty(goog.vec.Float32Array.prototype,"toString",goog.vec.Float32Array.prototype.toString),goog.exportSymbol("Float32Array",goog.vec.Float32Array));goog.vec.Float64Array=function(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0};goog.vec.Float64Array.BYTES_PER_ELEMENT=8;goog.vec.Float64Array.prototype.BYTES_PER_ELEMENT=8;goog.vec.Float64Array.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};goog.vec.Float64Array.prototype.toString=Array.prototype.join;
if("undefined"==typeof Float64Array){try{goog.exportProperty(goog.vec.Float64Array,"BYTES_PER_ELEMENT",goog.vec.Float64Array.BYTES_PER_ELEMENT)}catch(float64ArrayError){}goog.exportProperty(goog.vec.Float64Array.prototype,"BYTES_PER_ELEMENT",goog.vec.Float64Array.prototype.BYTES_PER_ELEMENT);goog.exportProperty(goog.vec.Float64Array.prototype,"set",goog.vec.Float64Array.prototype.set);goog.exportProperty(goog.vec.Float64Array.prototype,"toString",goog.vec.Float64Array.prototype.toString);goog.exportSymbol("Float64Array",
goog.vec.Float64Array)};goog.vec.EPSILON=1E-6;goog.vec.Vec2={};goog.vec.Vec2.createFloat32=function(){return new Float32Array(2)};goog.vec.Vec2.createFloat64=function(){return new Float64Array(2)};goog.vec.Vec2.createNumber=function(){var a=Array(2);goog.vec.Vec2.setFromValues(a,0,0);return a};goog.vec.Vec2.createFloat32FromArray=function(a){var b=goog.vec.Vec2.createFloat32();goog.vec.Vec2.setFromArray(b,a);return b};goog.vec.Vec2.createFloat32FromValues=function(a,b){var c=goog.vec.Vec2.createFloat32();goog.vec.Vec2.setFromValues(c,a,b);return c};
goog.vec.Vec2.cloneFloat32=goog.vec.Vec2.createFloat32FromArray;goog.vec.Vec2.createFloat64FromArray=function(a){var b=goog.vec.Vec2.createFloat64();goog.vec.Vec2.setFromArray(b,a);return b};goog.vec.Vec2.createFloat64FromValues=function(a,b){var c=goog.vec.Vec2.createFloat64();goog.vec.Vec2.setFromValues(c,a,b);return c};goog.vec.Vec2.cloneFloat64=goog.vec.Vec2.createFloat64FromArray;goog.vec.Vec2.setFromValues=function(a,b,c){a[0]=b;a[1]=c;return a};
goog.vec.Vec2.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];return a};goog.vec.Vec2.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c};goog.vec.Vec2.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c};goog.vec.Vec2.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];return b};goog.vec.Vec2.abs=function(a,b){b[0]=Math.abs(a[0]);b[1]=Math.abs(a[1]);return b};goog.vec.Vec2.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;return c};
goog.vec.Vec2.magnitudeSquared=function(a){var b=a[0];a=a[1];return b*b+a*a};goog.vec.Vec2.magnitude=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};goog.vec.Vec2.normalize=function(a,b){var c=1/goog.vec.Vec2.magnitude(a);b[0]=a[0]*c;b[1]=a[1]*c;return b};goog.vec.Vec2.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};goog.vec.Vec2.distanceSquared=function(a,b){var c=a[0]-b[0],d=a[1]-b[1];return c*c+d*d};goog.vec.Vec2.distance=function(a,b){return Math.sqrt(goog.vec.Vec2.distanceSquared(a,b))};
goog.vec.Vec2.direction=function(a,b,c){var d=b[0]-a[0];a=b[1]-a[1];(b=Math.sqrt(d*d+a*a))?(b=1/b,c[0]=d*b,c[1]=a*b):c[0]=c[1]=0;return c};goog.vec.Vec2.lerp=function(a,b,c,d){var e=a[0];a=a[1];d[0]=(b[0]-e)*c+e;d[1]=(b[1]-a)*c+a;return d};goog.vec.Vec2.max=function(a,b,c){goog.isNumber(b)?(c[0]=Math.max(a[0],b),c[1]=Math.max(a[1],b)):(c[0]=Math.max(a[0],b[0]),c[1]=Math.max(a[1],b[1]));return c};
goog.vec.Vec2.min=function(a,b,c){goog.isNumber(b)?(c[0]=Math.min(a[0],b),c[1]=Math.min(a[1],b)):(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]));return c};goog.vec.Vec2.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]};goog.vec.Vec3={};goog.vec.Vec3.createFloat32=function(){return new Float32Array(3)};goog.vec.Vec3.createFloat64=function(){return new Float64Array(3)};goog.vec.Vec3.createNumber=function(){var a=Array(3);goog.vec.Vec3.setFromValues(a,0,0,0);return a};goog.vec.Vec3.create=function(){return new Float32Array(3)};goog.vec.Vec3.createFloat32FromArray=function(a){var b=goog.vec.Vec3.createFloat32();goog.vec.Vec3.setFromArray(b,a);return b};
goog.vec.Vec3.createFloat32FromValues=function(a,b,c){var d=goog.vec.Vec3.createFloat32();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.cloneFloat32=goog.vec.Vec3.createFloat32FromArray;goog.vec.Vec3.createFloat64FromArray=function(a){var b=goog.vec.Vec3.createFloat64();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.createFloat64FromValues=function(a,b,c){var d=goog.vec.Vec3.createFloat64();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.cloneFloat64=goog.vec.Vec3.createFloat64FromArray;
goog.vec.Vec3.createFromArray=function(a){var b=goog.vec.Vec3.create();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.createFromValues=function(a,b,c){var d=goog.vec.Vec3.create();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.clone=function(a){var b=goog.vec.Vec3.create();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.setFromValues=function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a};goog.vec.Vec3.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};
goog.vec.Vec3.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};goog.vec.Vec3.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};goog.vec.Vec3.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};goog.vec.Vec3.abs=function(a,b){b[0]=Math.abs(a[0]);b[1]=Math.abs(a[1]);b[2]=Math.abs(a[2]);return b};goog.vec.Vec3.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};
goog.vec.Vec3.magnitudeSquared=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};goog.vec.Vec3.magnitude=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};goog.vec.Vec3.normalize=function(a,b){var c=1/goog.vec.Vec3.magnitude(a);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;return b};goog.vec.Vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};goog.vec.Vec3.cross=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c};
goog.vec.Vec3.distanceSquared=function(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e};goog.vec.Vec3.distance=function(a,b){return Math.sqrt(goog.vec.Vec3.distanceSquared(a,b))};goog.vec.Vec3.direction=function(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0;return c};goog.vec.Vec3.lerp=function(a,b,c,d){var e=a[0],f=a[1];a=a[2];d[0]=(b[0]-e)*c+e;d[1]=(b[1]-f)*c+f;d[2]=(b[2]-a)*c+a;return d};
goog.vec.Vec3.max=function(a,b,c){goog.isNumber(b)?(c[0]=Math.max(a[0],b),c[1]=Math.max(a[1],b),c[2]=Math.max(a[2],b)):(c[0]=Math.max(a[0],b[0]),c[1]=Math.max(a[1],b[1]),c[2]=Math.max(a[2],b[2]));return c};goog.vec.Vec3.min=function(a,b,c){goog.isNumber(b)?(c[0]=Math.min(a[0],b),c[1]=Math.min(a[1],b),c[2]=Math.min(a[2],b)):(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]));return c};
goog.vec.Vec3.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};goog.vec.Vec4={};goog.vec.Vec4.createFloat32=function(){return new Float32Array(4)};goog.vec.Vec4.createFloat64=function(){return new Float64Array(4)};goog.vec.Vec4.createNumber=function(){var a=Array(4);goog.vec.Vec4.setFromValues(a,0,0,0,0);return a};goog.vec.Vec4.create=function(){return new Float32Array(4)};goog.vec.Vec4.createFromArray=function(a){var b=goog.vec.Vec4.create();goog.vec.Vec4.setFromArray(b,a);return b};
goog.vec.Vec4.createFloat32FromArray=function(a){var b=goog.vec.Vec4.createFloat32();goog.vec.Vec4.setFromArray(b,a);return b};goog.vec.Vec4.createFloat32FromValues=function(a,b,c,d){var e=goog.vec.Vec4.createFloat32();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.cloneFloat32=goog.vec.Vec4.createFloat32FromArray;goog.vec.Vec4.createFloat64FromArray=function(a){var b=goog.vec.Vec4.createFloat64();goog.vec.Vec4.setFromArray(b,a);return b};
goog.vec.Vec4.createFloat64FromValues=function(a,b,c,d){var e=goog.vec.Vec4.createFloat64();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.cloneFloat64=goog.vec.Vec4.createFloat64FromArray;goog.vec.Vec4.createFromValues=function(a,b,c,d){var e=goog.vec.Vec4.create();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.clone=goog.vec.Vec4.createFromArray;goog.vec.Vec4.setFromValues=function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a};
goog.vec.Vec4.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};goog.vec.Vec4.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};goog.vec.Vec4.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c};goog.vec.Vec4.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};
goog.vec.Vec4.abs=function(a,b){b[0]=Math.abs(a[0]);b[1]=Math.abs(a[1]);b[2]=Math.abs(a[2]);b[3]=Math.abs(a[3]);return b};goog.vec.Vec4.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};goog.vec.Vec4.magnitudeSquared=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};goog.vec.Vec4.magnitude=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};
goog.vec.Vec4.normalize=function(a,b){var c=1/goog.vec.Vec4.magnitude(a);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c;return b};goog.vec.Vec4.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};goog.vec.Vec4.lerp=function(a,b,c,d){var e=a[0],f=a[1],g=a[2];a=a[3];d[0]=(b[0]-e)*c+e;d[1]=(b[1]-f)*c+f;d[2]=(b[2]-g)*c+g;d[3]=(b[3]-a)*c+a;return d};
goog.vec.Vec4.max=function(a,b,c){goog.isNumber(b)?(c[0]=Math.max(a[0],b),c[1]=Math.max(a[1],b),c[2]=Math.max(a[2],b),c[3]=Math.max(a[3],b)):(c[0]=Math.max(a[0],b[0]),c[1]=Math.max(a[1],b[1]),c[2]=Math.max(a[2],b[2]),c[3]=Math.max(a[3],b[3]));return c};goog.vec.Vec4.min=function(a,b,c){goog.isNumber(b)?(c[0]=Math.min(a[0],b),c[1]=Math.min(a[1],b),c[2]=Math.min(a[2],b),c[3]=Math.min(a[3],b)):(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c[3]=Math.min(a[3],b[3]));return c};
goog.vec.Vec4.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]};goog.vec.Mat4={};goog.vec.Mat4.createFloat32=function(){return new Float32Array(16)};goog.vec.Mat4.createFloat64=function(){return new Float64Array(16)};goog.vec.Mat4.createNumber=function(){var a=Array(16);goog.vec.Mat4.setFromValues(a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return a};goog.vec.Mat4.create=function(){return goog.vec.Mat4.createFloat32()};goog.vec.Mat4.createFloat32Identity=function(){var a=goog.vec.Mat4.createFloat32();a[0]=a[5]=a[10]=a[15]=1;return a};
goog.vec.Mat4.createFloat64Identity=function(){var a=goog.vec.Mat4.createFloat64();a[0]=a[5]=a[10]=a[15]=1;return a};goog.vec.Mat4.createNumberIdentity=function(){var a=Array(16);goog.vec.Mat4.setFromValues(a,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return a};goog.vec.Mat4.createIdentity=function(){return goog.vec.Mat4.createFloat32Identity()};goog.vec.Mat4.createFloat32FromArray=function(a){var b=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFloat32FromValues=function(a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p){var v=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromValues(v,a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p);return v};goog.vec.Mat4.cloneFloat32=goog.vec.Mat4.createFloat32FromArray;goog.vec.Mat4.createFloat64FromArray=function(a){var b=goog.vec.Mat4.createFloat64();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFloat64FromValues=function(a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p){var v=goog.vec.Mat4.createFloat64();goog.vec.Mat4.setFromValues(v,a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p);return v};goog.vec.Mat4.cloneFloat64=goog.vec.Mat4.createFloat64FromArray;goog.vec.Mat4.createFromArray=function(a){var b=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFromValues=function(a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p){return goog.vec.Mat4.createFloat32FromValues(a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p)};goog.vec.Mat4.clone=goog.vec.Mat4.createFromArray;goog.vec.Mat4.getElement=function(a,b,c){return a[b+4*c]};goog.vec.Mat4.setElement=function(a,b,c,d){a[b+4*c]=d;return a};
goog.vec.Mat4.setFromValues=function(a,b,c,d,e,f,g,h,k,l,n,m,q,r,t,p,v){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=k;a[8]=l;a[9]=n;a[10]=m;a[11]=q;a[12]=r;a[13]=t;a[14]=p;a[15]=v;return a};goog.vec.Mat4.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};
goog.vec.Mat4.setFromRowMajorArray=function(a,b){a[0]=b[0];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=b[1];a[5]=b[5];a[6]=b[9];a[7]=b[13];a[8]=b[2];a[9]=b[6];a[10]=b[10];a[11]=b[14];a[12]=b[3];a[13]=b[7];a[14]=b[11];a[15]=b[15];return a};goog.vec.Mat4.setDiagonalValues=function(a,b,c,d,e){a[0]=b;a[5]=c;a[10]=d;a[15]=e;return a};goog.vec.Mat4.setDiagonal=function(a,b){a[0]=b[0];a[5]=b[1];a[10]=b[2];a[15]=b[3];return a};
goog.vec.Mat4.getDiagonal=function(a,b,c){if(c)for(var d=0<c?4*c:-c,e=0;e<4-Math.abs(c);e++)b[e]=a[d+5*e];else b[0]=a[0],b[1]=a[5],b[2]=a[10],b[3]=a[15];return b};goog.vec.Mat4.setColumnValues=function(a,b,c,d,e,f){b*=4;a[b]=c;a[b+1]=d;a[b+2]=e;a[b+3]=f;return a};goog.vec.Mat4.setColumn=function(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];return a};goog.vec.Mat4.getColumn=function(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3];return c};
goog.vec.Mat4.setColumns=function(a,b,c,d,e){goog.vec.Mat4.setColumn(a,0,b);goog.vec.Mat4.setColumn(a,1,c);goog.vec.Mat4.setColumn(a,2,d);goog.vec.Mat4.setColumn(a,3,e);return a};goog.vec.Mat4.getColumns=function(a,b,c,d,e){goog.vec.Mat4.getColumn(a,0,b);goog.vec.Mat4.getColumn(a,1,c);goog.vec.Mat4.getColumn(a,2,d);goog.vec.Mat4.getColumn(a,3,e)};goog.vec.Mat4.setRowValues=function(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f;return a};
goog.vec.Mat4.setRow=function(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3];return a};goog.vec.Mat4.getRow=function(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12];return c};goog.vec.Mat4.setRows=function(a,b,c,d,e){goog.vec.Mat4.setRow(a,0,b);goog.vec.Mat4.setRow(a,1,c);goog.vec.Mat4.setRow(a,2,d);goog.vec.Mat4.setRow(a,3,e);return a};
goog.vec.Mat4.getRows=function(a,b,c,d,e){goog.vec.Mat4.getRow(a,0,b);goog.vec.Mat4.getRow(a,1,c);goog.vec.Mat4.getRow(a,2,d);goog.vec.Mat4.getRow(a,3,e)};goog.vec.Mat4.makeZero=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=0;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=0;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=0;return a};goog.vec.Mat4.makeIdentity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
goog.vec.Mat4.addMat=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];c[9]=a[9]+b[9];c[10]=a[10]+b[10];c[11]=a[11]+b[11];c[12]=a[12]+b[12];c[13]=a[13]+b[13];c[14]=a[14]+b[14];c[15]=a[15]+b[15];return c};
goog.vec.Mat4.subMat=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];c[9]=a[9]-b[9];c[10]=a[10]-b[10];c[11]=a[11]-b[11];c[12]=a[12]-b[12];c[13]=a[13]-b[13];c[14]=a[14]-b[14];c[15]=a[15]-b[15];return c};
goog.vec.Mat4.multScalar=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12]*b;c[13]=a[13]*b;c[14]=a[14]*b;c[15]=a[15]*b;return c};
goog.vec.Mat4.multMat=function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],k=a[5],l=a[6],n=a[7],m=a[8],q=a[9],r=a[10],t=a[11],p=a[12],v=a[13],F=a[14];a=a[15];var G=b[0],H=b[1],I=b[2],y=b[3],x=b[4],w=b[5],z=b[6],A=b[7],B=b[8],C=b[9],D=b[10],E=b[11],u=b[12],J=b[13],K=b[14];b=b[15];c[0]=d*G+h*H+m*I+p*y;c[1]=e*G+k*H+q*I+v*y;c[2]=f*G+l*H+r*I+F*y;c[3]=g*G+n*H+t*I+a*y;c[4]=d*x+h*w+m*z+p*A;c[5]=e*x+k*w+q*z+v*A;c[6]=f*x+l*w+r*z+F*A;c[7]=g*x+n*w+t*z+a*A;c[8]=d*B+h*C+m*D+p*E;c[9]=e*B+k*C+q*D+v*E;c[10]=f*B+
l*C+r*D+F*E;c[11]=g*B+n*C+t*D+a*E;c[12]=d*u+h*J+m*K+p*b;c[13]=e*u+k*J+q*K+v*b;c[14]=f*u+l*J+r*K+F*b;c[15]=g*u+n*J+t*K+a*b;return c};
goog.vec.Mat4.transpose=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
goog.vec.Mat4.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],l=a[8],n=a[9],m=a[10],q=a[11],r=a[12],t=a[13],p=a[14];a=a[15];return(b*g-c*f)*(m*a-q*p)-(b*h-d*f)*(n*a-q*t)+(b*k-e*f)*(n*p-m*t)+(c*h-d*g)*(l*a-q*r)-(c*k-e*g)*(l*p-m*r)+(d*k-e*h)*(l*t-n*r)};
goog.vec.Mat4.invert=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],n=a[8],m=a[9],q=a[10],r=a[11],t=a[12],p=a[13],v=a[14],F=a[15],G=c*h-d*g,H=c*k-e*g,I=c*l-f*g,y=d*k-e*h,x=d*l-f*h,w=e*l-f*k,z=n*p-m*t,A=n*v-q*t,B=n*F-r*t,C=m*v-q*p,D=m*F-r*p,E=q*F-r*v,u=G*E-H*D+I*C+y*B-x*A+w*z;if(0==u)return!1;u=1/u;b[0]=(h*E-k*D+l*C)*u;b[1]=(-d*E+e*D-f*C)*u;b[2]=(p*w-v*x+F*y)*u;b[3]=(-m*w+q*x-r*y)*u;b[4]=(-g*E+k*B-l*A)*u;b[5]=(c*E-e*B+f*A)*u;b[6]=(-t*w+v*I-F*H)*u;b[7]=(n*w-q*I+r*H)*u;b[8]=
(g*D-h*B+l*z)*u;b[9]=(-c*D+d*B-f*z)*u;b[10]=(t*x-p*I+F*G)*u;b[11]=(-n*x+m*I-r*G)*u;b[12]=(-g*C+h*A-k*z)*u;b[13]=(c*C-d*A+e*z)*u;b[14]=(-t*y+p*H-v*G)*u;b[15]=(n*y-m*H+q*G)*u;return!0};goog.vec.Mat4.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]&&a[6]==b[6]&&a[7]==b[7]&&a[8]==b[8]&&a[9]==b[9]&&a[10]==b[10]&&a[11]==b[11]&&a[12]==b[12]&&a[13]==b[13]&&a[14]==b[14]&&a[15]==b[15]};
goog.vec.Mat4.multVec3=function(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8]+a[12];c[1]=d*a[1]+e*a[5]+b*a[9]+a[13];c[2]=d*a[2]+e*a[6]+b*a[10]+a[14];return c};goog.vec.Mat4.multVec3NoTranslate=function(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8];c[1]=d*a[1]+e*a[5]+b*a[9];c[2]=d*a[2]+e*a[6]+b*a[10];return c};
goog.vec.Mat4.multVec3Projective=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f;return c};goog.vec.Mat4.multVec4=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12];c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13];c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14];c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15];return c};
goog.vec.Mat4.makeTranslate=function(a,b,c,d){goog.vec.Mat4.makeIdentity(a);return goog.vec.Mat4.setColumnValues(a,3,b,c,d,1)};goog.vec.Mat4.makeScale=function(a,b,c,d){goog.vec.Mat4.makeIdentity(a);return goog.vec.Mat4.setDiagonalValues(a,b,c,d,1)};goog.vec.Mat4.makeRotate=function(a,b,c,d,e){var f=Math.cos(b),g=1-f;b=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c*c*g+f,c*d*g+e*b,c*e*g-d*b,0,c*d*g-e*b,d*d*g+f,d*e*g+c*b,0,c*e*g+d*b,d*e*g-c*b,e*e*g+f,0,0,0,0,1)};
goog.vec.Mat4.makeRotateX=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,1,0,0,0,0,c,d,0,0,-d,c,0,0,0,0,1)};goog.vec.Mat4.makeRotateY=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1)};goog.vec.Mat4.makeRotateZ=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c,d,0,0,-d,c,0,0,0,0,1,0,0,0,0,1)};
goog.vec.Mat4.makeFrustum=function(a,b,c,d,e,f,g){return goog.vec.Mat4.setFromValues(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};goog.vec.Mat4.makePerspective=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return goog.vec.Mat4.setFromValues(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};
goog.vec.Mat4.makeOrtho=function(a,b,c,d,e,f,g){return goog.vec.Mat4.setFromValues(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};
goog.vec.Mat4.makeLookAt=function(a,b,c,d){var e=goog.vec.Mat4.tmpVec4_[0];goog.vec.Vec3.subtract(c,b,e);goog.vec.Vec3.normalize(e,e);e[3]=0;c=goog.vec.Mat4.tmpVec4_[1];goog.vec.Vec3.cross(e,d,c);goog.vec.Vec3.normalize(c,c);c[3]=0;d=goog.vec.Mat4.tmpVec4_[2];goog.vec.Vec3.cross(c,e,d);goog.vec.Vec3.normalize(d,d);d[3]=0;goog.vec.Vec3.negate(e,e);goog.vec.Mat4.setRow(a,0,c);goog.vec.Mat4.setRow(a,1,d);goog.vec.Mat4.setRow(a,2,e);goog.vec.Mat4.setRowValues(a,3,0,0,0,1);goog.vec.Mat4.translate(a,-b[0],
-b[1],-b[2]);return a};goog.vec.Mat4.toLookAt=function(a,b,c,d){var e=goog.vec.Mat4.tmpMat4_[0];if(!goog.vec.Mat4.invert(a,e))return!1;b&&(b[0]=e[12],b[1]=e[13],b[2]=e[14]);if(c||d)c||(c=goog.vec.Mat4.tmpVec3_[0]),c[0]=-a[2],c[1]=-a[6],c[2]=-a[10],goog.vec.Vec3.normalize(c,c);d&&(b=goog.vec.Mat4.tmpVec3_[1],b[0]=a[0],b[1]=a[4],b[2]=a[8],goog.vec.Vec3.cross(b,c,d),goog.vec.Vec3.normalize(d,d));return!0};
goog.vec.Mat4.makeEulerZXZ=function(a,b,c,d){var e=Math.cos(b);b=Math.sin(b);var f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);a[0]=e*g-f*b*d;a[1]=f*e*d+g*b;a[2]=d*c;a[3]=0;a[4]=-e*d-g*f*b;a[5]=e*f*g-b*d;a[6]=g*c;a[7]=0;a[8]=c*b;a[9]=-e*c;a[10]=f;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
goog.vec.Mat4.toEulerZXZ=function(a,b,c){var d=Math.sqrt(a[2]*a[2]+a[6]*a[6]);c=c?-1:1;d>goog.vec.EPSILON?(b[2]=Math.atan2(a[2]*c,a[6]*c),b[1]=Math.atan2(d*c,a[10]),b[0]=Math.atan2(a[8]*c,-a[9]*c)):(b[0]=0,b[1]=Math.atan2(d*c,a[10]),b[2]=Math.atan2(a[1],a[0]));b[0]=(b[0]+2*Math.PI)%(2*Math.PI);b[2]=(b[2]+2*Math.PI)%(2*Math.PI);b[1]=(b[1]*c+2*Math.PI)%(2*Math.PI)*c;return b};
goog.vec.Mat4.translate=function(a,b,c,d){return goog.vec.Mat4.setColumnValues(a,3,a[0]*b+a[4]*c+a[8]*d+a[12],a[1]*b+a[5]*c+a[9]*d+a[13],a[2]*b+a[6]*c+a[10]*d+a[14],a[3]*b+a[7]*c+a[11]*d+a[15])};goog.vec.Mat4.scale=function(a,b,c,d){return goog.vec.Mat4.setFromValues(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
goog.vec.Mat4.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],k=a[3],l=a[4],n=a[5],m=a[6],q=a[7],r=a[8],t=a[9],p=a[10],v=a[11],F=a[12],G=a[13],H=a[14],I=a[15],y=Math.cos(b),x=Math.sin(b),w=1-y;b=c*c*w+y;var z=c*d*w+e*x,A=c*e*w-d*x,B=c*d*w-e*x,C=d*d*w+y,D=d*e*w+c*x,E=c*e*w+d*x;c=d*e*w-c*x;e=e*e*w+y;return goog.vec.Mat4.setFromValues(a,f*b+l*z+r*A,g*b+n*z+t*A,h*b+m*z+p*A,k*b+q*z+v*A,f*B+l*C+r*D,g*B+n*C+t*D,h*B+m*C+p*D,k*B+q*C+v*D,f*E+l*c+r*e,g*E+n*c+t*e,h*E+m*c+p*e,k*E+q*c+v*e,F,G,H,I)};
goog.vec.Mat4.rotateX=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],k=a[10],l=a[11],n=Math.cos(b),m=Math.sin(b);a[4]=c*n+g*m;a[5]=d*n+h*m;a[6]=e*n+k*m;a[7]=f*n+l*m;a[8]=c*-m+g*n;a[9]=d*-m+h*n;a[10]=e*-m+k*n;a[11]=f*-m+l*n;return a};goog.vec.Mat4.rotateY=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],k=a[10],l=a[11],n=Math.cos(b),m=Math.sin(b);a[0]=c*n+g*-m;a[1]=d*n+h*-m;a[2]=e*n+k*-m;a[3]=f*n+l*-m;a[8]=c*m+g*n;a[9]=d*m+h*n;a[10]=e*m+k*n;a[11]=f*m+l*n;return a};
goog.vec.Mat4.rotateZ=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],n=Math.cos(b),m=Math.sin(b);a[0]=c*n+g*m;a[1]=d*n+h*m;a[2]=e*n+k*m;a[3]=f*n+l*m;a[4]=c*-m+g*n;a[5]=d*-m+h*n;a[6]=e*-m+k*n;a[7]=f*-m+l*n;return a};goog.vec.Mat4.getTranslation=function(a,b){b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};goog.vec.Mat4.tmpVec3_=[goog.vec.Vec3.createFloat64(),goog.vec.Vec3.createFloat64()];goog.vec.Mat4.tmpVec4_=[goog.vec.Vec4.createFloat64(),goog.vec.Vec4.createFloat64(),goog.vec.Vec4.createFloat64()];
goog.vec.Mat4.tmpMat4_=[goog.vec.Mat4.createFloat64()];Lemon.Camera=function(a){this.direction=goog.vec.Vec3.createFloat32();this.fov=45;this.limits=goog.vec.Vec2.createFloat32FromValues(.1,100);this.matrixProjection=goog.vec.Mat4.createFloat32Identity();this.matrixView=goog.vec.Mat4.createFloat32Identity();this.matrixViewNeedUpdate=!0;this.matrixViewProjection=goog.vec.Mat4.createFloat32Identity();this.matrixViewProjectionNeedUpdate=!0;this.position=goog.vec.Vec3.createFloat32FromValues(0,0,3);this.ratio=16/9;this.rotation=goog.vec.Quaternion.createFloat32FromValues(0,
0,0,1);this.type=a||Lemon.Camera.Type.Perspective;this.viewport=goog.vec.Vec4.createFloat32();this.zoomScale=1;this.setType(this.type)};Lemon.Camera.Type={Perspective:0,Orthographic:1};Lemon.Camera.prototype.lookAt=function(a,b,c){goog.vec.Vec3.setFromValues(this.direction,a,b,c);this.matrixViewNeedUpdate=!0};Lemon.Camera.prototype.move=function(a,b,c){goog.vec.Vec3.setFromValues(this.position,a,b,c);this.matrixViewNeedUpdate=!0};
Lemon.Camera.prototype.rotate=function(a,b){function c(a,b){return[a[3]*b[0]+a[0]*b[3]+a[2]*b[1]-a[1]*b[2],a[3]*b[1]+a[1]*b[3]+a[0]*b[2]-a[2]*b[0],a[3]*b[2]+a[2]*b[3]+a[1]*b[0]-a[0]*b[1],a[3]*b[3]+a[0]*b[0]+a[1]*b[1]-a[2]*b[2]]}var d=goog.vec.Quaternion.createFloat32FromValues(0,0,0,1),e=goog.vec.Quaternion.createFloat32FromValues(0,0,0,1);goog.vec.Quaternion.fromAngleAxis(a,[0,1,0],d);goog.vec.Quaternion.fromAngleAxis(-b,[1,0,0],e);goog.vec.Quaternion.concat(d,e,this.rotation);d=c(this.rotation,
[this.direction[0],this.direction[1],this.direction[2],0]);e=c(this.rotation,[this.position[0],this.position[1],this.position[2],0]);goog.vec.Vec3.setFromValues(this.direction,d[0],d[1],d[2]);goog.vec.Vec3.setFromValues(this.position,e[0],e[1],e[2]);this.matrixViewNeedUpdate=!0};Lemon.Camera.prototype.setFieldOfView=function(a){this.fov=a;this.setType(this.type)};Lemon.Camera.prototype.setRatio=function(a){this.ratio=a;this.setType(this.type)};
Lemon.Camera.prototype.setType=function(a){this.type=a;a==Lemon.Camera.Type.Perspective?goog.vec.Mat4.makePerspective(this.matrixProjection,goog.math.toRadians(this.fov*this.zoomScale),this.ratio,this.limits[0],this.limits[1]):goog.vec.Mat4.makeOrtho(this.matrixProjection,-1.5*this.ratio*this.zoomScale,1.5*this.ratio*this.zoomScale,-1.5*this.zoomScale,1.5*this.zoomScale,this.limits[0],this.limits[1]);this.matrixViewProjectionNeedUpdate=!0};
Lemon.Camera.prototype.setViewDistances=function(a,b){goog.vec.Vec2.setFromValues(this.limits,a,b);this.setType(this.type)};Lemon.Camera.prototype.setViewport=function(a,b,c,d){goog.vec.Vec4.setFromValues(this.viewport,a,b,c,d);this.setRatio(c/d)};Lemon.Camera.prototype.zoom=function(a){this.zoomScale=1/a;this.setType(this.type)};Lemon.Camera.prototype.getPosition=function(){return[this.position[0],this.position[1],this.position[2]]};Lemon.Camera.prototype.getProjectionMatrix=function(){return this.matrixProjection};
Lemon.Camera.prototype.getViewMatrix=function(){this.matrixViewNeedUpdate&&(goog.vec.Mat4.makeLookAt(this.matrixView,this.position,this.direction,goog.vec.Vec3.createFloat32FromValues(0,1,0)),this.matrixViewNeedUpdate=!1,this.matrixViewProjectionNeedUpdate=!0);return this.matrixView};Lemon.Camera.prototype.getViewport=function(){return this.viewport};
Lemon.Camera.prototype.getViewProjectionMatrix=function(){if(this.matrixViewProjectionNeedUpdate||this.matrixViewNeedUpdate)goog.vec.Mat4.multMat(this.getProjectionMatrix(),this.getViewMatrix(),this.matrixViewProjection),this.matrixViewProjectionNeedUpdate=!1;return this.matrixViewProjection};Lemon.RenderAPI=function(){this.activeCamera=null};Lemon.RenderAPI.prototype.bindLight=function(a){};Lemon.RenderAPI.prototype.applyStateBlock=function(a){this.setBlendMode(a.blendMode);this.setDepthState(a.depthTest,a.depthWrite,a.depthFunction);this.setFaceCulling(a.faceCulling);this.setStencilState(a.stencilTest,a.stencilWrite);this.setStencilFunction(a.stencilFunction,a.stencilReference,a.stencilMask);this.setStencilOperations(a.stencilTestFail,a.stencilDepthTestFail,a.stencilSuccess)};
Lemon.RenderAPI.prototype.bindFrameBuffer=function(a){};Lemon.RenderAPI.prototype.bindTexture=function(a,b){};Lemon.RenderAPI.prototype.bindTextureCube=function(a,b){};Lemon.RenderAPI.prototype.clear=function(a){};Lemon.RenderAPI.prototype.clearCache=function(){};Lemon.RenderAPI.prototype.createFrameBuffer=function(){return 0};Lemon.RenderAPI.prototype.drawIndexedPrimitives=function(a,b,c){};Lemon.RenderAPI.prototype.drawPrimitives=function(a,b,c){};
Lemon.RenderAPI.prototype.initFrameBuffer=function(a,b,c,d){};Lemon.RenderAPI.prototype.setActiveCamera=function(a){this.activeCamera=a};Lemon.RenderAPI.prototype.setBlendMode=function(a){};Lemon.RenderAPI.prototype.setDepthState=function(a,b,c){};Lemon.RenderAPI.prototype.setFaceCulling=function(a){};Lemon.RenderAPI.prototype.setGeometry=function(a){};Lemon.RenderAPI.prototype.setIndexBuffer=function(a){};Lemon.RenderAPI.prototype.setProgram=function(a){return-1};
Lemon.RenderAPI.prototype.setUniform=function(a,b,c,d,e){return!1};Lemon.RenderAPI.prototype.setScissorTest=function(a,b,c,d,e){};Lemon.RenderAPI.prototype.setStencilState=function(a,b){};Lemon.RenderAPI.prototype.setStencilFunction=function(a,b,c){};Lemon.RenderAPI.prototype.setStencilOperations=function(a,b,c){};Lemon.RenderAPI.prototype.setVertexBuffer=function(a,b){};Lemon.RenderAPI.prototype.setVertexFormat=function(a){};Lemon.RenderAPI.prototype.getActiveCamera=function(){return this.activeCamera};Lemon.RenderCommand=function(){};Lemon.RenderCommand.prototype.isOpaque=function(){return!0};Lemon.RenderCommand.prototype.execute=function(a){};Lemon.MeshCommand=function(a,b,c,d,e,f,g){Lemon.RenderCommand.call(this);this.endVertex=g;this.geometry=a;this.modelMatrix=d;this.normalMatrix=e;this.pass=b;this.program=c;this.startVertex=f};goog.inherits(Lemon.MeshCommand,Lemon.RenderCommand);
Lemon.MeshCommand.prototype.execute=function(a){var b=a.setProgram(this.program);if(-1!=b){1==b&&a.setUniform(this.program,"uCamera",Lemon.Type.Matrix,a.getActiveCamera().getViewProjectionMatrix());a.setUniform(this.program,"uModel",Lemon.Type.Matrix,this.modelMatrix);a.setUniform(this.program,"uModelNormal",Lemon.Type.Matrix,this.normalMatrix);a.applyStateBlock(this.pass);for(var b=this.pass.getParameters(),c=0,d=0;d<b.length;d++){var e=b[d];switch(e.type){case Lemon.Type.Texture2D:a.setUniform(this.program,
e.name,Lemon.Type.Int,c);a.bindTexture(c,e.value);c++;break;default:a.setUniform(this.program,e.name,e.type,e.value)}}a.setGeometry(this.geometry);a.drawIndexedPrimitives(this.pass.drawingMode,this.startVertex,this.endVertex)}};Lemon.SpriteCommand=function(a){Lemon.RenderCommand.call(this);this.sprite=a};goog.inherits(Lemon.SpriteCommand,Lemon.RenderCommand);Lemon.SpriteCommand.sharedGeometry=Lemon.Geometry.createRectangle(.5,.5);Lemon.SpriteCommand.sharedProgram=new Lemon.Program;Lemon.SpriteCommand.prototype.execute=function(a){Lemon.SpriteCommand.draw(a,this.sprite)};
Lemon.SpriteCommand.draw=function(a,b){var c=b.getTexture();if(c.isReady()){var d=b.getCustomProgram();if(!d)if(Lemon.SpriteCommand.isDefaultProgramLoaded())d=Lemon.SpriteCommand.sharedProgram;else return;var e=a.setProgram(d);if(-1!==e){var f=b.getTextureRect(),g=b.getSize();1===e&&a.setUniform(d,"uCamera",Lemon.Type.Matrix,a.getActiveCamera().getViewProjectionMatrix());a.setUniform(d,"uModel",Lemon.Type.Matrix,b.getTransformationMatrix());a.setBlendMode(b.getBlendMode());a.setDepthState(!0,!0,Lemon.DepthFunction.Less);
a.bindTexture(0,c);d=null;if(c instanceof Lemon.TextureVideo)d=new Float32Array([0,1,0,0,1,1,1,0]);else{var h=c.getImage().getSize(),c=f[0]/h[0],d=(f[1]+f[3])/h[1],e=(f[0]+f[2])/h[0],h=f[1]/h[1];0===f[2]&&0===f[3]&&(e=h=1);d=new Float32Array([c,h,c,d,e,h,e,d])}Lemon.SpriteCommand.sharedGeometry.setTextureUVs(d);f=b.getColor();f=new Float32Array([f.r,f.g,f.b,f.a,f.r,f.g,f.b,f.a,f.r,f.g,f.b,f.a,f.r,f.g,f.b,f.a]);Lemon.SpriteCommand.sharedGeometry.setColors(f);g=new Float32Array([-g[0],-g[1],0,-g[0],
g[1],0,g[0],-g[1],0,g[0],g[1],0]);Lemon.SpriteCommand.sharedGeometry.setPositions(g);a.setGeometry(Lemon.SpriteCommand.sharedGeometry);a.drawIndexedPrimitives(Lemon.DrawingMode.TrianglesStrip,0,4)}}};
Lemon.SpriteCommand.isDefaultProgramLoaded=function(){if(Lemon.SpriteCommand.sharedProgram.isReady())return!0;Lemon.SpriteCommand.sharedProgram.loadFromData("uniform mat4 uCamera;uniform mat4 uModel;attribute vec4 aPosition;attribute vec4 aColor;attribute vec2 aTexCoord;varying vec4 vColor;varying vec2 vUV;void main() {gl_Position = (uCamera * uModel) * aPosition;vColor      = aColor;vUV         = aTexCoord;}","uniform lowp sampler2D texture;varying lowp vec4 vColor;varying mediump vec2 vUV;void main() {gl_FragColor = texture2D(texture, vUV) * vColor;}");
return!1};Lemon.RenderTask=function(){this.opaqueQueue=[];this.transparentQueue=[]};Lemon.RenderTask.prototype.addCommand=function(a,b){var c=b||0;a.isOpaque()?(this.opaqueQueue[c]=this.opaqueQueue[c]||[],this.opaqueQueue[c].push(a)):(this.transparentQueue[c]=this.transparentQueue[c]||[],this.transparentQueue[c].push(a))};
Lemon.RenderTask.prototype.execute=function(a){for(var b=0,c=0,b=0;b<this.opaqueQueue.length;b++)for(c=0;c<this.opaqueQueue[b].length;c++)this.opaqueQueue[b][c].execute(a);for(b=0;b<this.transparentQueue.length;b++)for(c=0;c<this.transparentQueue[b].length;c++)this.transparentQueue[b][c].execute(a)};Lemon.RenderTarget=function(){this.activeTask=null;this.context=new Lemon.Private.Context;this.tasks=[];this.renderApi=null};Lemon.RenderTarget.prototype.clear=function(a){};Lemon.RenderTarget.prototype.display=function(){for(var a=0;a<this.tasks.length;a++)this.tasks[a].execute(this.renderApi)};Lemon.RenderTarget.prototype.createTask=function(){this.tasks.push(new Lemon.RenderTask);return this.tasks.length-1};
Lemon.RenderTarget.prototype.render=function(a,b){this.renderApi.clearCache();this.renderApi.setActiveCamera(b);this.getActiveTask()||this.setActiveTask(this.createTask());a.visit(this)};Lemon.RenderTarget.prototype.setActiveTask=function(a){0<=a&&a<this.tasks.length&&(this.activeTask=this.tasks[a])};Lemon.RenderTarget.prototype.getActiveTask=function(){return this.activeTask};Lemon.RenderTarget.prototype.removeTasks=function(){this.tasks.length=0;this.activeTask=null};
Lemon.RenderTarget.prototype.getRenderAPI=function(){return this.renderApi};Lemon.RenderTarget.prototype.getSize=function(){return this.context.getSize()};goog.vec.Quaternion={};goog.vec.Quaternion.createFloat32=goog.vec.Vec4.createFloat32;goog.vec.Quaternion.createFloat64=goog.vec.Vec4.createFloat64;goog.vec.Quaternion.createNumber=goog.vec.Vec4.createNumber;goog.vec.Quaternion.createFloat32FromArray=goog.vec.Vec4.createFloat32FromArray;goog.vec.Quaternion.createFloat64FromArray=goog.vec.Vec4.createFloat64FromArray;goog.vec.Quaternion.createFloat32FromValues=goog.vec.Vec4.createFloat32FromValues;goog.vec.Quaternion.createFloat64FromValues=goog.vec.Vec4.createFloat64FromValues;
goog.vec.Quaternion.cloneFloat32=goog.vec.Vec4.cloneFloat32;goog.vec.Quaternion.cloneFloat64=goog.vec.Vec4.cloneFloat64;goog.vec.Quaternion.setFromValues=goog.vec.Vec4.setFromValues;goog.vec.Quaternion.setFromArray=goog.vec.Vec4.setFromArray;goog.vec.Quaternion.add=goog.vec.Vec4.add;goog.vec.Quaternion.negate=goog.vec.Vec4.negate;goog.vec.Quaternion.scale=goog.vec.Vec4.scale;goog.vec.Quaternion.magnitudeSquared=goog.vec.Vec4.magnitudeSquared;goog.vec.Quaternion.magnitude=goog.vec.Vec4.magnitude;
goog.vec.Quaternion.normalize=goog.vec.Vec4.normalize;goog.vec.Quaternion.dot=goog.vec.Vec4.dot;goog.vec.Quaternion.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};goog.vec.Quaternion.concat=function(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],k=b[2];b=b[3];c[0]=a*g+d*b+e*k-f*h;c[1]=a*h-d*k+e*b+f*g;c[2]=a*k+d*h-e*g+f*b;c[3]=a*b-d*g-e*h-f*k;return c};
goog.vec.Quaternion.fromAngleAxis=function(a,b,c){goog.vec.Vec3.normalize(b,b);a*=.5;var d=Math.sin(a);goog.vec.Quaternion.setFromValues(c,d*b[0],d*b[1],d*b[2],Math.cos(a));goog.vec.Quaternion.normalize(c,c);return c};goog.vec.Quaternion.toAngleAxis=function(a,b){var c=2*Math.acos(a[3]);Math.min(Math.max(1-a[3]*a[3],0),1)<goog.vec.EPSILON?goog.vec.Vec3.setFromValues(b,1,0,0):(goog.vec.Vec3.setFromValues(b,a[0],a[1],a[2]),goog.vec.Vec3.normalize(b,b));c>Math.PI&&(c-=2*Math.PI);return c};
goog.vec.Quaternion.fromRotationMatrix4=function(a,b){var c=a[0],d=a[5],e=a[10];b[3]=Math.sqrt(Math.max(0,1+c+d+e))/2;b[0]=Math.sqrt(Math.max(0,1+c-d-e))/2;b[1]=Math.sqrt(Math.max(0,1-c+d-e))/2;b[2]=Math.sqrt(Math.max(0,1-c-d+e))/2;b[0]=0>a[6]-a[9]!=0>b[0]?-b[0]:b[0];b[1]=0>a[8]-a[2]!=0>b[1]?-b[1]:b[1];b[2]=0>a[1]-a[4]!=0>b[2]?-b[2]:b[2];return b};
goog.vec.Quaternion.toRotationMatrix4=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=2*c,h=2*d,k=2*e,l=g*f,n=h*f,f=k*f,g=g*c,m=h*c,c=k*c,h=h*d,d=k*d,e=k*e;b[0]=1-(h+e);b[1]=m+f;b[2]=c-n;b[3]=0;b[4]=m-f;b[5]=1-(g+e);b[6]=d+l;b[7]=0;b[8]=c+n;b[9]=d-l;b[10]=1-(g+h);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
goog.vec.Quaternion.slerp=function(a,b,c,d){var e=goog.vec.Quaternion.dot(a,b);if(1<e||-1>e)return goog.vec.Vec4.setFromArray(d,b),d;var f=1;0>e&&(f=-1,e=-e);var g=Math.acos(e);if(g<=goog.vec.EPSILON)return goog.vec.Vec4.setFromArray(d,b),d;var h=1/Math.sin(g),e=Math.sin((1-c)*g)*h;c=f*Math.sin(c*g)*h;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};goog.vec.Quaternion.nlerp=goog.vec.Vec4.lerp;Lemon.Transformable=function(){this.matrix=goog.vec.Mat4.createFloat32Identity();this.normalMatrix=goog.vec.Mat4.createFloat32Identity();this.origin=goog.vec.Vec3.createFloat32();this.position=goog.vec.Vec3.createFloat32();this.rotation=goog.vec.Quaternion.createFloat32();this.rotationMatrix=goog.vec.Mat4.createFloat32Identity();this.scale=goog.vec.Vec3.createFloat32FromValues(1,1,1);this.needTransformUpdate=!0};
Lemon.Transformable.prototype.lookAt=function(a,b){a=a||[0,0,0];b=b||[0,1,0];var c=goog.vec.Vec3.createFloat32(),d=goog.vec.Vec3.createFloat32(),e=goog.vec.Vec3.createFloat32();goog.vec.Vec3.subtract(a,this.position,e);goog.vec.Vec3.normalize(e,e);goog.vec.Vec3.subtract(a,this.position,e);goog.vec.Vec3.normalize(e,e);goog.vec.Vec3.cross(b,e,c);goog.vec.Vec3.normalize(c,c);goog.vec.Vec3.cross(e,c,d);var f=goog.vec.Mat4.createFloat32Identity();f[0]=c[0];f[1]=c[1];f[2]=c[2];f[3]=0;f[4]=d[0];f[5]=d[1];
f[6]=d[2];f[7]=0;f[8]=e[0];f[9]=e[1];f[10]=e[2];f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;this.setRotationFromMatrix(f)};Lemon.Transformable.prototype.setOrigin=function(a,b,c){goog.vec.Vec3.setFromValues(this.origin,a,b,c);this.needTransformUpdate=!0};Lemon.Transformable.prototype.setPosition=function(a,b,c){goog.vec.Vec3.setFromValues(this.position,a,b,c);this.needTransformUpdate=!0};
Lemon.Transformable.prototype.setRotation=function(a,b,c){goog.vec.Mat4.makeIdentity(this.rotationMatrix);goog.vec.Mat4.rotateX(this.rotationMatrix,goog.math.toRadians(a));goog.vec.Mat4.rotateY(this.rotationMatrix,goog.math.toRadians(b));goog.vec.Mat4.rotateZ(this.rotationMatrix,goog.math.toRadians(c));goog.vec.Quaternion.fromRotationMatrix4(this.rotationMatrix,this.rotation);this.needTransformUpdate=!0};
Lemon.Transformable.prototype.setRotationFromQuaternion=function(a){goog.vec.Quaternion.toRotationMatrix4(a,this.rotationMatrix);this.rotation=a;this.needTransformUpdate=!0};Lemon.Transformable.prototype.setRotationFromMatrix=function(a){goog.vec.Quaternion.fromRotationMatrix4(a,this.rotation);this.rotationMatrix=a;this.needTransformUpdate=!0};Lemon.Transformable.prototype.setScale=function(a,b,c){goog.vec.Vec3.setFromValues(this.scale,a,b,c);this.needTransformUpdate=!0};
Lemon.Transformable.prototype.computeTransformationMatrix=function(a,b){if(!b&&!this.needTransformUpdate)return!1;goog.vec.Mat4.makeTranslate(this.matrix,this.position[0],this.position[1],this.position[2]);goog.vec.Mat4.multMat(this.matrix,this.rotationMatrix,this.matrix);goog.vec.Mat4.scale(this.matrix,this.scale[0],this.scale[1],this.scale[2]);a&&goog.vec.Mat4.multMat(a,this.matrix,this.matrix);goog.vec.Mat4.invert(this.matrix,this.normalMatrix);goog.vec.Mat4.transpose(this.normalMatrix,this.normalMatrix);
this.needTransformUpdate=!1;return!0};Lemon.Transformable.prototype.getTransformationMatrix=function(){return this.matrix};Lemon.Transformable.prototype.getNormalMatrix=function(){return this.normalMatrix};Lemon.Transformable.prototype.getOrigin=function(){return this.origin};Lemon.Transformable.prototype.getPosition=function(){return this.position};Lemon.Transformable.prototype.getRotation=function(){throw"'getRotation' is not implemented for now \u2026";};
Lemon.Transformable.prototype.getScale=function(){return this.scale};Lemon.Node=function(a){Lemon.Transformable.call(this);this.children=[];this.name=a||"";this.parent=null};goog.inherits(Lemon.Node,Lemon.Transformable);Lemon.Node.prototype.addChild=function(a){a!=this&&(a.parent&&a.parent.removeChild(a),this.children.push(a),a.parent=this)};Lemon.Node.prototype.findChild=function(a){for(var b=0;b<this.children.length;b++){if(this.children[b].name==a)return this.children[b];var c=this.children[b].findChild(a);if(c)return c}return null};
Lemon.Node.prototype.removeChild=function(a){var b=this.children.indexOf(a);return-1!=b?(this.children.splice(b,1),a.parent=null,!0):!1};Lemon.Node.prototype.setName=function(a){this.name=a};Lemon.Node.prototype.update=function(a,b){var c=this.parent?this.parent.getTransformationMatrix():null;return this.computeTransformationMatrix(c,b)};Lemon.Node.prototype.visit=function(a){};Lemon.Node.prototype.getChildren=function(){return this.children};Lemon.Node.prototype.isRoot=function(){return null===this.parent};Lemon.Light=function(){Lemon.Node.call(this);this.ambient=new Lemon.Color(255,255,255);this.diffuse=new Lemon.Color(255,255,255);this.specular=new Lemon.Color(255,255,255)};goog.inherits(Lemon.Light,Lemon.Node);Lemon.Light.prototype.visit=function(a){a.getRenderAPI().bindLight(this)};Lemon.Light.prototype.setAmbientColor=function(a,b,c){this.ambient.set(a,b,c)};Lemon.Light.prototype.setDiffuseColor=function(a,b,c){this.diffuse.set(a,b,c)};
Lemon.Light.prototype.setSpecularColor=function(a,b,c){this.specular.set(a,b,c)};Lemon.Light.prototype.getAmbientColor=function(){return this.ambient};Lemon.Light.prototype.getDiffuseColor=function(){return this.diffuse};Lemon.Light.prototype.getSpecularColor=function(){return this.specular};Lemon.DirectionalLight=function(){Lemon.Light.call(this);this.direction=[]};goog.inherits(Lemon.DirectionalLight,Lemon.Light);Lemon.DirectionalLight.prototype.setDirection=function(a,b,c){this.direction=[a,b,c]};Lemon.DirectionalLight.prototype.getDirection=function(){return this.direction};Lemon.PointLight=function(){Lemon.Light.call(this);this.constant=1;this.linear=.09;this.quadratic=.032};goog.inherits(Lemon.PointLight,Lemon.Light);Lemon.PointLight.prototype.setValues=function(a,b,c){this.constant=a;this.linear=b;this.quadratic=c};Lemon.PointLight.prototype.getValues=function(){return[this.constant,this.linear,this.quadratic]};Lemon.SpotLight=function(){Lemon.Light.call(this);this.constant=1;this.cutoff=12.5;this.direction=[];this.linear=.09;this.quadratic=.032};goog.inherits(Lemon.SpotLight,Lemon.Light);Lemon.SpotLight.prototype.setDirection=function(a,b,c){this.direction=[a,b,c]};Lemon.SpotLight.prototype.setCutoff=function(a){this.cutoff=a};Lemon.SpotLight.prototype.setValues=function(a,b,c){this.constant=a;this.linear=b;this.quadratic=c};Lemon.SpotLight.prototype.getDirection=function(){return this.direction};
Lemon.SpotLight.prototype.getValues=function(){return[this.constant,this.linear,this.quadratic]};Lemon.Drawable=function(){Lemon.Node.call(this)};goog.inherits(Lemon.Drawable,Lemon.Node);Lemon.Drawable.prototype.draw=function(a){};Lemon.Drawable.prototype.visit=function(a){this.draw(a)};Lemon.Mesh=function(){Lemon.Drawable.call(this);this.program=this.material=this.geometry=null};goog.inherits(Lemon.Mesh,Lemon.Drawable);Lemon.Mesh.prototype.draw=function(a){if(this.geometry&&this.material&&this.program){a=a.getActiveTask();for(var b=this.material.getActiveTechnique(),c=this.material.getPassCount(b),d=0;d<c;d++)a.addCommand(new Lemon.MeshCommand(this.geometry,this.material.getPass(b,d),this.program,this.getTransformationMatrix(),this.getNormalMatrix(),0,this.geometry.getIndexCount()))}};
Lemon.Mesh.prototype.setGeometry=function(a){this.geometry=a};Lemon.Mesh.prototype.setMaterial=function(a){this.material=a};Lemon.Mesh.prototype.setProgram=function(a){this.program=a};Lemon.Mesh.prototype.getProgram=function(){return this.program};Lemon.Loaders.ModelLoader=function(){};Lemon.Loaders.ModelLoader.loadFromFile=function(a,b){Lemon.Loaders.FileLoader.load(a,function(a,b,e){a=e.filePath.replace(/[^\/]*$/,"");Lemon.Loaders.ModelLoader.parse(b,e.model,a)},{model:b,filePath:a})};
Lemon.Loaders.ModelLoader.parse=function(a,b,c){c=c||"";a=JSON.parse(a);var d=[],e,f,g;for(e=0;e<a.materials.length;e++){var h=new Lemon.Material,k=h.createPass();k.drawingMode=Lemon.DrawingMode.Triangles;g=a.materials[e].properties;for(f=0;f<g.length;f++){var l=g[f];if(1==l.type)"$mat.twosided"==l.key&&1==l.value?k.faceCulling=Lemon.FaceCulling.None:"$mat.shininess"==l.key?k.add("material.shininess",Lemon.Type.Float,l.value):"$clr.ambient"==l.key?k.add("material.ambient",Lemon.Type.Float,[l.value[0],
l.value[1],l.value[2]]):"$clr.diffuse"==l.key?k.add("material.diffuse",Lemon.Type.Float,[l.value[0],l.value[1],l.value[2]]):"$clr.specular"==l.key?k.add("material.specular",Lemon.Type.Float,[l.value[0],l.value[1],l.value[2]]):"$clr.emissive"==l.key&&k.add("material.emissive",Lemon.Type.Float,[l.value[0],l.value[1],l.value[2]]);else if(3==l.type&&"?mat.name"!=l.key){var n=new Lemon.Texture;n.loadFromFile(c+l.value);var m="material.diffuseTexture";switch(l.semantic){default:case 1:m="material.diffuseTexture";
break;case 2:m="material.specularTexture";break;case 3:m="material.ambientTexture";break;case 4:m="material.emissiveTexture";break;case 5:m="material.heightTexture";break;case 6:m="material.normalsTexture";break;case 7:m="material.shininessTexture";break;case 8:m="material.opacityTexture";break;case 9:m="material.displacementTexture"}k.add(m,Lemon.Type.Texture2D,n)}}d.push(h)}for(e=0;e<a.meshes.length;e++){c=new Lemon.Mesh;b.meshes.push(c);h=a.meshes[e];k=new Lemon.Geometry;f=new Lemon.VertexFormat;
k.setVertexFormat(f);g=new Float32Array(h.vertices);f.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Position,0,Lemon.VertexElement.Type.Float,3,!1));k.setPositions(g);g=new Float32Array(h.normals);f.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.Normal,1,Lemon.VertexElement.Type.Float,3,!1));k.setNormals(g);h.texturecoords&&(g=new Float32Array(h.texturecoords[0]),f.add(new Lemon.VertexElement(Lemon.VertexElement.Usage.UVS,2,Lemon.VertexElement.Type.Float,h.numuvcomponents[0],!1)),k.setTextureUVs(g));
l=new Uint16Array(3*h.faces.length);for(g=f=0;f<h.faces.length;f++,g+=3)l[g+0]=h.faces[f][0],l[g+1]=h.faces[f][1],l[g+2]=h.faces[f][2];k.setIndices(l);c.setGeometry(k);void 0!==h.materialindex&&d[h.materialindex]?c.setMaterial(d[h.materialindex]):(h=new Lemon.Material,k=h.createPass(),k.drawingMode=Lemon.DrawingMode.Triangles,k.add("material.ambient",Lemon.Type.Float,[0,0,0]),k.add("material.diffuse",Lemon.Type.Float,[.55,.55,.55]),k.add("material.specular",Lemon.Type.Float,[.7,.7,.7]),k.add("material.shininess",
Lemon.Type.Float,38.4),c.setMaterial(h));c.setProgram(Lemon.ProgramLibrary.get("PhongShader"))}};Lemon.Model=function(){Lemon.Drawable.call(this);this.meshes=[]};goog.inherits(Lemon.Model,Lemon.Drawable);Lemon.Model.prototype.update=function(a,b){for(var c=Lemon.Node.prototype.update.call(this,a,b),d=0;d<this.meshes.length;d++)this.meshes[d].computeTransformationMatrix(this.getTransformationMatrix(),c);return c};Lemon.Model.prototype.draw=function(a){for(var b=0;b<this.meshes.length;b++)this.meshes[b].draw(a)};
Lemon.Model.prototype.loadFromFile=function(a){Lemon.Loaders.ModelLoader.loadFromFile(a,this)};Lemon.Sprite=function(){Lemon.Drawable.call(this);this.blendMode=new Lemon.BlendMode(Lemon.BlendMode.Mode.Alpha);this.color=new Lemon.Color(255,255,255,255);this.rect=[0,0,0,0];this.size=[.5,.5];this.texture=this.customProgram=null};goog.inherits(Lemon.Sprite,Lemon.Drawable);Lemon.Sprite.prototype.setBlendMode=function(a){this.blendMode=a};Lemon.Sprite.prototype.setColor=function(a,b,c,d){this.color.set(a,b,c,d)};Lemon.Sprite.prototype.draw=function(a){this.texture&&a.getActiveTask().addCommand(new Lemon.SpriteCommand(this))};
Lemon.Sprite.prototype.setCustomProgram=function(a){this.customProgram=a};Lemon.Sprite.prototype.setSize=function(a,b){this.size[0]=a;this.size[1]=b};Lemon.Sprite.prototype.setTexture=function(a){this.texture=a};Lemon.Sprite.prototype.setTextureRect=function(a,b,c,d){this.rect=[a,b,c,d]};Lemon.Sprite.prototype.getBlendMode=function(){return this.blendMode};Lemon.Sprite.prototype.getColor=function(){return this.color};Lemon.Sprite.prototype.getCustomProgram=function(){return this.customProgram};
Lemon.Sprite.prototype.getSize=function(){return this.size};Lemon.Sprite.prototype.getTexture=function(){return this.texture};Lemon.Sprite.prototype.getTextureRect=function(){return this.rect};Lemon.WebGL={};Lemon.WebGL.Cache=function(){this.clearColor=new Lemon.Color(1,1,1,255);this.vertexFormat=this.texture=this.program=null;this.lights=[];this.lightsAmbient=[];this.lightsDiffuse=[];this.lightsData=[];this.lightsDirection=[];this.lightsPosition=[];this.lightsSpecular=[];this.lightsType=[]};Lemon.Scene=function(){this.root=new Lemon.Node("root")};Lemon.Scene.prototype.add=function(a){this.root.addChild(a)};Lemon.Scene.prototype.find=function(a){return this.root.findChild(a)};Lemon.Scene.prototype.remove=function(a){return this.root.removeChild(a)};Lemon.Scene.prototype.update=function(a){function b(a,d,e){var f=a.update(d,e);a=a.getChildren();for(var g=0;g<a.length;g++)b(a[g],d,f||e)}b(this.root,a,!1)};
Lemon.Scene.prototype.visit=function(a){function b(a,d){a.visit(d);for(var e=a.getChildren(),f=0;f<e.length;f++)b(e[f],d)}b(this.root,a)};goog.webgl={};goog.webgl.DEPTH_BUFFER_BIT=256;goog.webgl.STENCIL_BUFFER_BIT=1024;goog.webgl.COLOR_BUFFER_BIT=16384;goog.webgl.POINTS=0;goog.webgl.LINES=1;goog.webgl.LINE_LOOP=2;goog.webgl.LINE_STRIP=3;goog.webgl.TRIANGLES=4;goog.webgl.TRIANGLE_STRIP=5;goog.webgl.TRIANGLE_FAN=6;goog.webgl.ZERO=0;goog.webgl.ONE=1;goog.webgl.SRC_COLOR=768;goog.webgl.ONE_MINUS_SRC_COLOR=769;goog.webgl.SRC_ALPHA=770;goog.webgl.ONE_MINUS_SRC_ALPHA=771;goog.webgl.DST_ALPHA=772;goog.webgl.ONE_MINUS_DST_ALPHA=773;
goog.webgl.DST_COLOR=774;goog.webgl.ONE_MINUS_DST_COLOR=775;goog.webgl.SRC_ALPHA_SATURATE=776;goog.webgl.FUNC_ADD=32774;goog.webgl.BLEND_EQUATION=32777;goog.webgl.BLEND_EQUATION_RGB=32777;goog.webgl.BLEND_EQUATION_ALPHA=34877;goog.webgl.FUNC_SUBTRACT=32778;goog.webgl.FUNC_REVERSE_SUBTRACT=32779;goog.webgl.BLEND_DST_RGB=32968;goog.webgl.BLEND_SRC_RGB=32969;goog.webgl.BLEND_DST_ALPHA=32970;goog.webgl.BLEND_SRC_ALPHA=32971;goog.webgl.CONSTANT_COLOR=32769;goog.webgl.ONE_MINUS_CONSTANT_COLOR=32770;
goog.webgl.CONSTANT_ALPHA=32771;goog.webgl.ONE_MINUS_CONSTANT_ALPHA=32772;goog.webgl.BLEND_COLOR=32773;goog.webgl.ARRAY_BUFFER=34962;goog.webgl.ELEMENT_ARRAY_BUFFER=34963;goog.webgl.ARRAY_BUFFER_BINDING=34964;goog.webgl.ELEMENT_ARRAY_BUFFER_BINDING=34965;goog.webgl.STREAM_DRAW=35040;goog.webgl.STATIC_DRAW=35044;goog.webgl.DYNAMIC_DRAW=35048;goog.webgl.BUFFER_SIZE=34660;goog.webgl.BUFFER_USAGE=34661;goog.webgl.CURRENT_VERTEX_ATTRIB=34342;goog.webgl.FRONT=1028;goog.webgl.BACK=1029;
goog.webgl.FRONT_AND_BACK=1032;goog.webgl.CULL_FACE=2884;goog.webgl.BLEND=3042;goog.webgl.DITHER=3024;goog.webgl.STENCIL_TEST=2960;goog.webgl.DEPTH_TEST=2929;goog.webgl.SCISSOR_TEST=3089;goog.webgl.POLYGON_OFFSET_FILL=32823;goog.webgl.SAMPLE_ALPHA_TO_COVERAGE=32926;goog.webgl.SAMPLE_COVERAGE=32928;goog.webgl.NO_ERROR=0;goog.webgl.INVALID_ENUM=1280;goog.webgl.INVALID_VALUE=1281;goog.webgl.INVALID_OPERATION=1282;goog.webgl.OUT_OF_MEMORY=1285;goog.webgl.CW=2304;goog.webgl.CCW=2305;
goog.webgl.LINE_WIDTH=2849;goog.webgl.ALIASED_POINT_SIZE_RANGE=33901;goog.webgl.ALIASED_LINE_WIDTH_RANGE=33902;goog.webgl.CULL_FACE_MODE=2885;goog.webgl.FRONT_FACE=2886;goog.webgl.DEPTH_RANGE=2928;goog.webgl.DEPTH_WRITEMASK=2930;goog.webgl.DEPTH_CLEAR_VALUE=2931;goog.webgl.DEPTH_FUNC=2932;goog.webgl.STENCIL_CLEAR_VALUE=2961;goog.webgl.STENCIL_FUNC=2962;goog.webgl.STENCIL_FAIL=2964;goog.webgl.STENCIL_PASS_DEPTH_FAIL=2965;goog.webgl.STENCIL_PASS_DEPTH_PASS=2966;goog.webgl.STENCIL_REF=2967;
goog.webgl.STENCIL_VALUE_MASK=2963;goog.webgl.STENCIL_WRITEMASK=2968;goog.webgl.STENCIL_BACK_FUNC=34816;goog.webgl.STENCIL_BACK_FAIL=34817;goog.webgl.STENCIL_BACK_PASS_DEPTH_FAIL=34818;goog.webgl.STENCIL_BACK_PASS_DEPTH_PASS=34819;goog.webgl.STENCIL_BACK_REF=36003;goog.webgl.STENCIL_BACK_VALUE_MASK=36004;goog.webgl.STENCIL_BACK_WRITEMASK=36005;goog.webgl.VIEWPORT=2978;goog.webgl.SCISSOR_BOX=3088;goog.webgl.COLOR_CLEAR_VALUE=3106;goog.webgl.COLOR_WRITEMASK=3107;goog.webgl.UNPACK_ALIGNMENT=3317;
goog.webgl.PACK_ALIGNMENT=3333;goog.webgl.MAX_TEXTURE_SIZE=3379;goog.webgl.MAX_VIEWPORT_DIMS=3386;goog.webgl.SUBPIXEL_BITS=3408;goog.webgl.RED_BITS=3410;goog.webgl.GREEN_BITS=3411;goog.webgl.BLUE_BITS=3412;goog.webgl.ALPHA_BITS=3413;goog.webgl.DEPTH_BITS=3414;goog.webgl.STENCIL_BITS=3415;goog.webgl.POLYGON_OFFSET_UNITS=10752;goog.webgl.POLYGON_OFFSET_FACTOR=32824;goog.webgl.TEXTURE_BINDING_2D=32873;goog.webgl.SAMPLE_BUFFERS=32936;goog.webgl.SAMPLES=32937;goog.webgl.SAMPLE_COVERAGE_VALUE=32938;
goog.webgl.SAMPLE_COVERAGE_INVERT=32939;goog.webgl.COMPRESSED_TEXTURE_FORMATS=34467;goog.webgl.DONT_CARE=4352;goog.webgl.FASTEST=4353;goog.webgl.NICEST=4354;goog.webgl.GENERATE_MIPMAP_HINT=33170;goog.webgl.BYTE=5120;goog.webgl.UNSIGNED_BYTE=5121;goog.webgl.SHORT=5122;goog.webgl.UNSIGNED_SHORT=5123;goog.webgl.INT=5124;goog.webgl.UNSIGNED_INT=5125;goog.webgl.FLOAT=5126;goog.webgl.DEPTH_COMPONENT=6402;goog.webgl.ALPHA=6406;goog.webgl.RGB=6407;goog.webgl.RGBA=6408;goog.webgl.LUMINANCE=6409;
goog.webgl.LUMINANCE_ALPHA=6410;goog.webgl.UNSIGNED_SHORT_4_4_4_4=32819;goog.webgl.UNSIGNED_SHORT_5_5_5_1=32820;goog.webgl.UNSIGNED_SHORT_5_6_5=33635;goog.webgl.FRAGMENT_SHADER=35632;goog.webgl.VERTEX_SHADER=35633;goog.webgl.MAX_VERTEX_ATTRIBS=34921;goog.webgl.MAX_VERTEX_UNIFORM_VECTORS=36347;goog.webgl.MAX_VARYING_VECTORS=36348;goog.webgl.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661;goog.webgl.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660;goog.webgl.MAX_TEXTURE_IMAGE_UNITS=34930;
goog.webgl.MAX_FRAGMENT_UNIFORM_VECTORS=36349;goog.webgl.SHADER_TYPE=35663;goog.webgl.DELETE_STATUS=35712;goog.webgl.LINK_STATUS=35714;goog.webgl.VALIDATE_STATUS=35715;goog.webgl.ATTACHED_SHADERS=35717;goog.webgl.ACTIVE_UNIFORMS=35718;goog.webgl.ACTIVE_ATTRIBUTES=35721;goog.webgl.SHADING_LANGUAGE_VERSION=35724;goog.webgl.CURRENT_PROGRAM=35725;goog.webgl.NEVER=512;goog.webgl.LESS=513;goog.webgl.EQUAL=514;goog.webgl.LEQUAL=515;goog.webgl.GREATER=516;goog.webgl.NOTEQUAL=517;goog.webgl.GEQUAL=518;
goog.webgl.ALWAYS=519;goog.webgl.KEEP=7680;goog.webgl.REPLACE=7681;goog.webgl.INCR=7682;goog.webgl.DECR=7683;goog.webgl.INVERT=5386;goog.webgl.INCR_WRAP=34055;goog.webgl.DECR_WRAP=34056;goog.webgl.VENDOR=7936;goog.webgl.RENDERER=7937;goog.webgl.VERSION=7938;goog.webgl.NEAREST=9728;goog.webgl.LINEAR=9729;goog.webgl.NEAREST_MIPMAP_NEAREST=9984;goog.webgl.LINEAR_MIPMAP_NEAREST=9985;goog.webgl.NEAREST_MIPMAP_LINEAR=9986;goog.webgl.LINEAR_MIPMAP_LINEAR=9987;goog.webgl.TEXTURE_MAG_FILTER=10240;
goog.webgl.TEXTURE_MIN_FILTER=10241;goog.webgl.TEXTURE_WRAP_S=10242;goog.webgl.TEXTURE_WRAP_T=10243;goog.webgl.TEXTURE_2D=3553;goog.webgl.TEXTURE=5890;goog.webgl.TEXTURE_CUBE_MAP=34067;goog.webgl.TEXTURE_BINDING_CUBE_MAP=34068;goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_X=34069;goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_X=34070;goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_Y=34071;goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072;goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_Z=34073;goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074;
goog.webgl.MAX_CUBE_MAP_TEXTURE_SIZE=34076;goog.webgl.TEXTURE0=33984;goog.webgl.TEXTURE1=33985;goog.webgl.TEXTURE2=33986;goog.webgl.TEXTURE3=33987;goog.webgl.TEXTURE4=33988;goog.webgl.TEXTURE5=33989;goog.webgl.TEXTURE6=33990;goog.webgl.TEXTURE7=33991;goog.webgl.TEXTURE8=33992;goog.webgl.TEXTURE9=33993;goog.webgl.TEXTURE10=33994;goog.webgl.TEXTURE11=33995;goog.webgl.TEXTURE12=33996;goog.webgl.TEXTURE13=33997;goog.webgl.TEXTURE14=33998;goog.webgl.TEXTURE15=33999;goog.webgl.TEXTURE16=34E3;
goog.webgl.TEXTURE17=34001;goog.webgl.TEXTURE18=34002;goog.webgl.TEXTURE19=34003;goog.webgl.TEXTURE20=34004;goog.webgl.TEXTURE21=34005;goog.webgl.TEXTURE22=34006;goog.webgl.TEXTURE23=34007;goog.webgl.TEXTURE24=34008;goog.webgl.TEXTURE25=34009;goog.webgl.TEXTURE26=34010;goog.webgl.TEXTURE27=34011;goog.webgl.TEXTURE28=34012;goog.webgl.TEXTURE29=34013;goog.webgl.TEXTURE30=34014;goog.webgl.TEXTURE31=34015;goog.webgl.ACTIVE_TEXTURE=34016;goog.webgl.REPEAT=10497;goog.webgl.CLAMP_TO_EDGE=33071;
goog.webgl.MIRRORED_REPEAT=33648;goog.webgl.FLOAT_VEC2=35664;goog.webgl.FLOAT_VEC3=35665;goog.webgl.FLOAT_VEC4=35666;goog.webgl.INT_VEC2=35667;goog.webgl.INT_VEC3=35668;goog.webgl.INT_VEC4=35669;goog.webgl.BOOL=35670;goog.webgl.BOOL_VEC2=35671;goog.webgl.BOOL_VEC3=35672;goog.webgl.BOOL_VEC4=35673;goog.webgl.FLOAT_MAT2=35674;goog.webgl.FLOAT_MAT3=35675;goog.webgl.FLOAT_MAT4=35676;goog.webgl.SAMPLER_2D=35678;goog.webgl.SAMPLER_CUBE=35680;goog.webgl.VERTEX_ATTRIB_ARRAY_ENABLED=34338;
goog.webgl.VERTEX_ATTRIB_ARRAY_SIZE=34339;goog.webgl.VERTEX_ATTRIB_ARRAY_STRIDE=34340;goog.webgl.VERTEX_ATTRIB_ARRAY_TYPE=34341;goog.webgl.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922;goog.webgl.VERTEX_ATTRIB_ARRAY_POINTER=34373;goog.webgl.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975;goog.webgl.COMPILE_STATUS=35713;goog.webgl.LOW_FLOAT=36336;goog.webgl.MEDIUM_FLOAT=36337;goog.webgl.HIGH_FLOAT=36338;goog.webgl.LOW_INT=36339;goog.webgl.MEDIUM_INT=36340;goog.webgl.HIGH_INT=36341;goog.webgl.FRAMEBUFFER=36160;
goog.webgl.RENDERBUFFER=36161;goog.webgl.RGBA4=32854;goog.webgl.RGB5_A1=32855;goog.webgl.RGB565=36194;goog.webgl.DEPTH_COMPONENT16=33189;goog.webgl.STENCIL_INDEX=6401;goog.webgl.STENCIL_INDEX8=36168;goog.webgl.DEPTH_STENCIL=34041;goog.webgl.RENDERBUFFER_WIDTH=36162;goog.webgl.RENDERBUFFER_HEIGHT=36163;goog.webgl.RENDERBUFFER_INTERNAL_FORMAT=36164;goog.webgl.RENDERBUFFER_RED_SIZE=36176;goog.webgl.RENDERBUFFER_GREEN_SIZE=36177;goog.webgl.RENDERBUFFER_BLUE_SIZE=36178;
goog.webgl.RENDERBUFFER_ALPHA_SIZE=36179;goog.webgl.RENDERBUFFER_DEPTH_SIZE=36180;goog.webgl.RENDERBUFFER_STENCIL_SIZE=36181;goog.webgl.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048;goog.webgl.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049;goog.webgl.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050;goog.webgl.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051;goog.webgl.COLOR_ATTACHMENT0=36064;goog.webgl.DEPTH_ATTACHMENT=36096;goog.webgl.STENCIL_ATTACHMENT=36128;goog.webgl.DEPTH_STENCIL_ATTACHMENT=33306;
goog.webgl.NONE=0;goog.webgl.FRAMEBUFFER_COMPLETE=36053;goog.webgl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054;goog.webgl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055;goog.webgl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057;goog.webgl.FRAMEBUFFER_UNSUPPORTED=36061;goog.webgl.FRAMEBUFFER_BINDING=36006;goog.webgl.RENDERBUFFER_BINDING=36007;goog.webgl.MAX_RENDERBUFFER_SIZE=34024;goog.webgl.INVALID_FRAMEBUFFER_OPERATION=1286;goog.webgl.UNPACK_FLIP_Y_WEBGL=37440;goog.webgl.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441;
goog.webgl.CONTEXT_LOST_WEBGL=37442;goog.webgl.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443;goog.webgl.BROWSER_DEFAULT_WEBGL=37444;goog.webgl.HALF_FLOAT_OES=36193;goog.webgl.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723;goog.webgl.VERTEX_ARRAY_BINDING_OES=34229;goog.webgl.UNMASKED_VENDOR_WEBGL=37445;goog.webgl.UNMASKED_RENDERER_WEBGL=37446;goog.webgl.COMPRESSED_RGB_S3TC_DXT1_EXT=33776;goog.webgl.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777;goog.webgl.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778;
goog.webgl.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779;goog.webgl.TEXTURE_MAX_ANISOTROPY_EXT=34046;goog.webgl.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047;Lemon.RenderAPI.WebGL=function(){Lemon.RenderAPI.call(this);this.cache=new Lemon.WebGL.Cache;this.enabledVertexAttribArray=[];this.instances=new Lemon.WebGLObjects.Instances;this.state=new Lemon.StateBlock;this.initStateBlockWithDefaultValues(this.state)};goog.inherits(Lemon.RenderAPI.WebGL,Lemon.RenderAPI);goog.addSingletonGetter(Lemon.RenderAPI.WebGL);Lemon.RenderAPI.WebGL.prototype.bindLight=function(a){this.cache.lights.push(a)};
Lemon.RenderAPI.WebGL.prototype.bindFrameBuffer=function(a){var b=Lemon.GetContext();-1==a?b.bindFramebuffer(goog.webgl.FRAMEBUFFER,null):(a=this.instances.frameBuffers[a])&&b.bindFramebuffer(goog.webgl.FRAMEBUFFER,a)};
Lemon.RenderAPI.WebGL.prototype.bindTexture=function(a,b){if(b.isReady()){var c=b instanceof Lemon.TextureVideo,d=!1,e=Lemon.GetContext(),f=this.instances.textures[b.getUID()];f||(f=e.createTexture(),this.instances.textures[b.getUID()]=f,d=!0);this.cache.texture!=b&&(e.activeTexture(goog.webgl.TEXTURE0+a),e.bindTexture(goog.webgl.TEXTURE_2D,f));d?(f=[0,0],e.pixelStorei(goog.webgl.UNPACK_FLIP_Y_WEBGL,!0),c?e.texImage2D(goog.webgl.TEXTURE_2D,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,
b.getVideoData()):(f=b.getImage(),d=f.getData(),f=f.getSize(),d instanceof Image?e.texImage2D(goog.webgl.TEXTURE_2D,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d):e.texImage2D(goog.webgl.TEXTURE_2D,0,goog.webgl.RGBA,f[0],f[1],0,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d)),d=0===(f[0]&f[0]-1)&&0===(f[1]&f[1]-1),e.texParameteri(goog.webgl.TEXTURE_2D,goog.webgl.TEXTURE_WRAP_S,b.isRepeated()?goog.webgl.REPEAT:goog.webgl.CLAMP_TO_EDGE),e.texParameteri(goog.webgl.TEXTURE_2D,goog.webgl.TEXTURE_WRAP_T,
b.isRepeated()?goog.webgl.REPEAT:goog.webgl.CLAMP_TO_EDGE),e.texParameteri(goog.webgl.TEXTURE_2D,goog.webgl.TEXTURE_MAG_FILTER,b.isSmoothed()?goog.webgl.LINEAR:goog.webgl.NEAREST),f=d&&b.isMipmaped()?goog.webgl.LINEAR_MIPMAP_NEAREST:goog.webgl.LINEAR,e.texParameteri(goog.webgl.TEXTURE_2D,goog.webgl.TEXTURE_MIN_FILTER,b.isSmoothed()?f:goog.webgl.NEAREST),!c&&d&&b.isMipmaped()&&e.generateMipmap(goog.webgl.TEXTURE_2D)):c&&e.texImage2D(goog.webgl.TEXTURE_2D,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,
b.getVideoData());this.cache.texture=b}};
Lemon.RenderAPI.WebGL.prototype.bindTextureCube=function(a,b){if(b.isReady()){var c=Lemon.GetContext(),d=!1,e=this.instances.textures[b.getUID()];e||(e=c.createTexture(),this.instances.textures[b.getUID()]=e,d=!0);this.cache.texture!=b&&(c.activeTexture(goog.webgl.TEXTURE0+a),c.bindTexture(goog.webgl.TEXTURE_CUBE_MAP,e));d&&(d=b.getImages(),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_X,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d[Lemon.TextureCube.Face.Left].getData()),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_X,
0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d[Lemon.TextureCube.Face.Right].getData()),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_Y,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d[Lemon.TextureCube.Face.Up].getData()),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d[Lemon.TextureCube.Face.Down].getData()),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_POSITIVE_Z,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,
d[Lemon.TextureCube.Face.Front].getData()),c.texImage2D(goog.webgl.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,goog.webgl.RGBA,goog.webgl.RGBA,goog.webgl.UNSIGNED_BYTE,d[Lemon.TextureCube.Face.Back].getData()),c.texParameteri(goog.webgl.TEXTURE_CUBE_MAP,goog.webgl.TEXTURE_MAG_FILTER,goog.webgl.NEAREST),c.texParameteri(goog.webgl.TEXTURE_CUBE_MAP,goog.webgl.TEXTURE_MIN_FILTER,goog.webgl.NEAREST));this.cache.texture=b}};
Lemon.RenderAPI.WebGL.prototype.clear=function(a){a.isEqual(this.cache.clearColor)||(Lemon.GetContext().clearColor(a.r,a.g,a.b,a.a),this.cache.clearColor=a);Lemon.GetContext().clear(goog.webgl.COLOR_BUFFER_BIT|goog.webgl.DEPTH_BUFFER_BIT|goog.webgl.DEPTH_BUFFER_BIT)};Lemon.RenderAPI.WebGL.prototype.clearCache=function(){this.cache.program=null;this.cache.lights.length=0};
Lemon.RenderAPI.WebGL.prototype.createFrameBuffer=function(){var a=this.instances.frameBuffers.length,b=Lemon.GetContext().createFramebuffer();this.instances.frameBuffers.push(b);return a};Lemon.RenderAPI.WebGL.prototype.drawIndexedPrimitives=function(a,b,c){Lemon.GetContext().drawElements(this.convertDrawingModeToConstant(a),c,goog.webgl.UNSIGNED_SHORT,b);this.disableVertexAttribArray()};
Lemon.RenderAPI.WebGL.prototype.drawPrimitives=function(a,b,c){Lemon.GetContext().drawArrays(this.convertDrawingModeToConstant(a),b,c);this.disableVertexAttribArray()};Lemon.RenderAPI.WebGL.prototype.disableVertexAttribArray=function(){var a=Lemon.GetContext(),b;for(b in this.enabledVertexAttribArray)a.disableVertexAttribArray(b)};
Lemon.RenderAPI.WebGL.prototype.initFrameBuffer=function(a,b,c,d){if(this.instances.frameBuffers[a]){var e=Lemon.GetContext(),f=[0,0];this.bindFrameBuffer(a);for(a=0;a<b.length;a++){this.bindTexture(a,b[a]);var f=b[a].getImage().getSize(),g=this.instances.textures[b[a].getUID()];e.framebufferTexture2D(goog.webgl.FRAMEBUFFER,e.COLOR_ATTACHMENT0+a,goog.webgl.TEXTURE_2D,g,0)}if(c||d)b=e.createRenderbuffer(),e.bindRenderbuffer(goog.webgl.RENDERBUFFER,b),d?(e.renderbufferStorage(goog.webgl.RENDERBUFFER,
goog.webgl.DEPTH_STENCIL,f[0],f[1]),e.framebufferRenderbuffer(goog.webgl.FRAMEBUFFER,goog.webgl.DEPTH_STENCIL_ATTACHMENT,goog.webgl.RENDERBUFFER,b)):(e.renderbufferStorage(goog.webgl.RENDERBUFFER,goog.webgl.DEPTH_COMPONENT16,f[0],f[1]),e.framebufferRenderbuffer(goog.webgl.FRAMEBUFFER,goog.webgl.DEPTH_ATTACHMENT,goog.webgl.RENDERBUFFER,b)),e.bindRenderbuffer(goog.webgl.RENDERBUFFER,null);this.bindFrameBuffer(-1)}};
Lemon.RenderAPI.WebGL.prototype.initStateBlockWithDefaultValues=function(a){this.state.depthTest=!1;this.state.depthWrite=!1;this.state.stencilTest=!1};
Lemon.RenderAPI.WebGL.prototype.sendLights=function(a){if(this.instances.programs[a.getUID()]){for(var b=this.cache.lights.length,c=this.cache.lights[0],d=!1,e=!1,f=0,g=0;f<this.cache.lights.length;f++,g+=3){c=this.cache.lights[f];this.cache.lightsType[f]=c instanceof Lemon.PointLight?0:c instanceof Lemon.DirectionalLight?1:2;var h=c.getAmbientColor();this.cache.lightsAmbient[g]=h.r;this.cache.lightsAmbient[g+1]=h.g;this.cache.lightsAmbient[g+2]=h.b;1!=this.cache.lightsType[f]?(d=c.getValues(),this.cache.lightsData[g]=
d[0],this.cache.lightsData[g+1]=d[1],this.cache.lightsData[g+2]=d[2],d=!0):(this.cache.lightsData[g]=0,this.cache.lightsData[g+1]=0,this.cache.lightsData[g+2]=0);h=c.getDiffuseColor();this.cache.lightsDiffuse[g]=h.r;this.cache.lightsDiffuse[g+1]=h.g;this.cache.lightsDiffuse[g+2]=h.b;0!==this.cache.lightsType[f]?(e=c.getDirection(),this.cache.lightsDirection[g]=e[0],this.cache.lightsDirection[g+1]=e[1],this.cache.lightsDirection[g+2]=e[2],e=!0):(this.cache.lightsDirection[g]=0,this.cache.lightsDirection[g+
1]=0,this.cache.lightsDirection[g+2]=0);h=c.getPosition();this.cache.lightsPosition[g]=h[0];this.cache.lightsPosition[g+1]=h[1];this.cache.lightsPosition[g+2]=h[2];c=c.getSpecularColor();this.cache.lightsSpecular[g]=c.r;this.cache.lightsSpecular[g+1]=c.g;this.cache.lightsSpecular[g+2]=c.b}this.cache.lights.length&&(this.setUniform(a,"uCameraPosition",Lemon.Type.Float,this.activeCamera.getPosition()),this.setUniform(a,"lights.count",Lemon.Type.Int,b),this.setUniform(a,"lights.ambient",Lemon.Type.Float,
this.cache.lightsAmbient,3),d&&this.setUniform(a,"lights.data",Lemon.Type.Float,this.cache.lightsData,3),this.setUniform(a,"lights.diffuse",Lemon.Type.Float,this.cache.lightsDiffuse,3),e&&this.setUniform(a,"lights.direction",Lemon.Type.Float,this.cache.lightsDirection,3),this.setUniform(a,"lights.position",Lemon.Type.Float,this.cache.lightsPosition,3),this.setUniform(a,"lights.specular",Lemon.Type.Float,this.cache.lightsSpecular,3),this.setUniform(a,"lights.type",Lemon.Type.Int,this.cache.lightsType,
1))}};Lemon.RenderAPI.WebGL.prototype.setActiveCamera=function(a){Lemon.RenderAPI.prototype.setActiveCamera.call(this,a);a=a.getViewport();Lemon.GetContext().viewport(a[0],a[1],a[2],a[3])};
Lemon.RenderAPI.WebGL.prototype.setBlendMode=function(a){if(!a.isEqual(this.state.blendMode)){var b=Lemon.GetContext();a.colorSourceFactor==Lemon.BlendMode.Factor.One&&a.colorDestinationFactor==Lemon.BlendMode.Factor.Zero?b.disable(goog.webgl.BLEND):(b.enable(goog.webgl.BLEND),b.blendEquationSeparate(this.convertBlendingEquationToConstant(a.colorEquation),this.convertBlendingEquationToConstant(a.alphaEquation)),b.blendFuncSeparate(this.convertBlendingFactorToConstant(a.colorSourceFactor),this.convertBlendingFactorToConstant(a.colorDestinationFactor),
this.convertBlendingFactorToConstant(a.alphaSourceFactor),this.convertBlendingFactorToConstant(a.alphaDestinationFactor)));this.state.blendMode=a}};
Lemon.RenderAPI.WebGL.prototype.setDepthState=function(a,b,c){var d=Lemon.GetContext();!a&&this.state.depthTest?d.disable(goog.webgl.DEPTH_TEST):a&&(this.state.depthTest||d.enable(goog.webgl.DEPTH_TEST),this.state.writeTest!=b&&(d.depthMask(b),this.state.writeTest=b),this.state.depthFunction!=c&&(d.depthFunc(this.convertDepthFunctionToConstant(c)),this.state.depthFunction=c));this.state.depthTest=a};
Lemon.RenderAPI.WebGL.prototype.setFaceCulling=function(a){if(this.state.faceCulling!=a){var b=Lemon.GetContext();a==Lemon.FaceCulling.None?b.disable(goog.webgl.CULL_FACE):(this.state.faceCulling==Lemon.FaceCulling.None&&b.enable(goog.webgl.CULL_FACE),a==Lemon.FaceCulling.Front?b.cullFace(goog.webgl.FRONT):b.cullFace(goog.webgl.BACK));this.state.faceCulling=a}};Lemon.RenderAPI.WebGL.prototype.setIndexBuffer=function(a){Lemon.GetContext().bindBuffer(goog.webgl.ELEMENT_ARRAY_BUFFER,a)};
Lemon.RenderAPI.WebGL.prototype.setGeometry=function(a){if(a.getVertexFormat()){this.setVertexFormat(a.getVertexFormat());var b=Lemon.GetContext(),c=this.instances.buffers[a.getUID()];c||(c=new Lemon.WebGLObjects.BufferData,this.instances.buffers[a.getUID()]=c);c.indexBuffer||(c.indexBuffer=b.createBuffer());this.setIndexBuffer(c.indexBuffer);this.cache.vertexFormat.isIndicesWaitingUpdate()&&(b.bufferData(goog.webgl.ELEMENT_ARRAY_BUFFER,a.getIndices(),goog.webgl.STATIC_DRAW),this.cache.vertexFormat.setIndicesAsWaitingUpdate(!1));
for(var d=this.cache.vertexFormat.getElements(),e=0;e<d.length;e++)if(c.vertexBuffers[e]||(c.vertexBuffers[e]=b.createBuffer()),this.setVertexBuffer(e,c.vertexBuffers[e]),this.cache.vertexFormat.isStreamWaitingUpdate(d[e].stream)){var f=this.convertStreamTypeToConstant(this.cache.vertexFormat.getStreamType(d[e].stream));switch(d[e].usage){case Lemon.VertexElement.Usage.Position:b.bufferData(goog.webgl.ARRAY_BUFFER,a.getVerticesPositions(),f);break;case Lemon.VertexElement.Usage.Color:b.bufferData(goog.webgl.ARRAY_BUFFER,
a.getVerticesColors(),f);break;case Lemon.VertexElement.Usage.UVS:b.bufferData(goog.webgl.ARRAY_BUFFER,a.getVerticesUVs(),f);break;case Lemon.VertexElement.Usage.Normal:b.bufferData(goog.webgl.ARRAY_BUFFER,a.getVerticesNormals(),f);break;default:case Lemon.VertexElement.Usage.Tangent:console.log("Given vertex element is not supported for now.")}this.cache.vertexFormat.setStreamAsWaitingUpdate(d[e].usage,!1)}}};
Lemon.RenderAPI.WebGL.prototype.setProgram=function(a){var b=this.instances.programs[a.getUID()],c=Lemon.GetContext();if(!b){if(!a.isReady())return-1;var b=a.getSources(),d=c.createProgram(),e=c.createShader(goog.webgl.VERTEX_SHADER);c.shaderSource(e,b[0]);c.compileShader(e);var f=c.createShader(goog.webgl.FRAGMENT_SHADER);c.shaderSource(f,b[1]);c.compileShader(f);c.attachShader(d,e);c.attachShader(d,f);c.bindAttribLocation(d,Lemon.VertexElement.Usage.Position,"aPosition");c.bindAttribLocation(d,
Lemon.VertexElement.Usage.UVS,"aTexCoord");c.bindAttribLocation(d,Lemon.VertexElement.Usage.Color,"aColor");c.bindAttribLocation(d,Lemon.VertexElement.Usage.Normal,"aNormal");c.bindAttribLocation(d,Lemon.VertexElement.Usage.Tangent,"aTangent");c.linkProgram(d);c.deleteShader(e);c.deleteShader(f);for(var b=this.instances.programs[a.getUID()]=d,f=c.getProgramParameter(d,goog.webgl.ACTIVE_UNIFORMS),g=a.getUniforms(),e=0;e<f;e++){var h=c.getActiveUniform(d,e),k=h.name,l=h.name.indexOf("[",h.name.length-
3);0<=l&&(k=h.name.substring(0,l));g[k]=new Lemon.Program.Element(c.getUniformLocation(d,h.name),k,this.convertConstantToShaderTypes(h.type),h.size)}f=c.getProgramParameter(d,goog.webgl.ACTIVE_ATTRIBUTES);g=a.getAttributes();for(e=0;e<f;e++)h=c.getActiveAttrib(d,e),g[h.name]=new Lemon.Program.Element(c.getAttribLocation(d,h.name),h.name,this.convertConstantToShaderTypes(h.type),h.size)}return this.cache.program!=b?(c.useProgram(b),this.cache.program=b,this.sendLights(a),1):0};
Lemon.RenderAPI.WebGL.prototype.setUniform=function(a,b,c,d,e){e=e||0;this.setProgram(a);a=a.getUniform(b);if(!a||!d)return!1;b=Lemon.GetContext();switch(c){case Lemon.Type.Float:d instanceof Array?e&&1<=e?2==e?b.uniform2fv(a.location,d):3==e?b.uniform3fv(a.location,d):4==e?b.uniform4fv(a.location,d):1==e&&b.uniform1fv(a.location,d):3==d.length?b.uniform3f(a.location,d[0],d[1],d[2]):4==d.length?b.uniform4f(a.location,d[0],d[1],d[2],d[3]):3==d.length&&b.uniform2f(a.location,d[0],d[1]):b.uniform1f(a.location,
d);break;case Lemon.Type.Int:d instanceof Array?e&&1<=e?2==e?b.uniform2iv(a.location,d):3==e?b.uniform3iv(a.location,d):4==e?b.uniform4iv(a.location,d):1==e&&b.uniform1iv(a.location,d):3==d.length?b.uniform3i(a.location,d[0],d[1],d[2]):4==d.length?b.uniform4i(a.location,d[0],d[1],d[2],d[3]):2==d.length&&b.uniform2i(a.location,d[0],d[1]):b.uniform1i(a.location,d);break;case Lemon.Type.Matrix:16==d.length?b.uniformMatrix4fv(a.location,!1,d):4==d.length?b.uniformMatrix2fv(a.location,!1,d):9==d.length&&
b.uniformMatrix3fv(a.location,!1,d)}return!0};Lemon.RenderAPI.WebGL.prototype.setScissorTest=function(a,b,c,d,e){var f=Lemon.GetContext();a?(f.enable(goog.webgl.SCISSOR_TEST),f.scissor(b,c,d,e)):f.disable(goog.webgl.SCISSOR_TEST)};
Lemon.RenderAPI.WebGL.prototype.setStencilState=function(a,b){var c=Lemon.GetContext();!a&&this.state.stencilTest?c.disable(goog.webgl.STENCIL_TEST):a&&(this.state.stencilTest||c.enable(goog.webgl.STENCIL_TEST),this.state.stencilWrite!=b&&(c.stencilMask(b),this.state.stencilWrite=b));this.state.stencilTest=a};
Lemon.RenderAPI.WebGL.prototype.setStencilFunction=function(a,b,c){if(this.state.stencilFunction!=a||this.state.stencilReference!=b||this.state.stencilMask!=c)Lemon.GetContext().stencilFunc(this.convertStencilFunctionToConstant(a),b,c),this.state.stencilFunction=a,this.state.stencilReference=b,this.state.stencilMask=c};
Lemon.RenderAPI.WebGL.prototype.setStencilOperations=function(a,b,c){if(this.state.stencilTestFail!=a||this.state.stencilDepthTestFail!=b||this.state.stencilSuccess!=c)Lemon.GetContext().stencilOp(this.convertStencilOperationToConstant(a),this.convertStencilOperationToConstant(b),this.convertStencilOperationToConstant(c)),this.state.stencilTestFail=a,this.state.stencilDepthTestFail=b,this.state.stencilSuccess=c};
Lemon.RenderAPI.WebGL.prototype.setVertexBuffer=function(a,b){var c=Lemon.GetContext();c.bindBuffer(goog.webgl.ARRAY_BUFFER,b);for(var d=this.cache.vertexFormat.getElements(),e=0;e<d.length;e++)d[e].stream==a&&(c.enableVertexAttribArray(d[e].usage),c.vertexAttribPointer(d[e].usage,d[e].count,this.convertVertexTypeToConstant(d[e].type),d[e].normalize,this.cache.vertexFormat.getStreamStride(d[e].stream),d[e].offset),this.enabledVertexAttribArray[d[e].usage]=!0)};
Lemon.RenderAPI.WebGL.prototype.setVertexFormat=function(a){this.cache.vertexFormat=a};
Lemon.RenderAPI.WebGL.prototype.convertBlendingFactorToConstant=function(a){switch(a){default:case Lemon.BlendMode.Factor.Zero:return goog.webgl.ZERO;case Lemon.BlendMode.Factor.One:return goog.webgl.ONE;case Lemon.BlendMode.Factor.SourceColor:return goog.webgl.SRC_COLOR;case Lemon.BlendMode.Factor.OneMinusSourceColor:return goog.webgl.ONE_MINUS_SRC_COLOR;case Lemon.BlendMode.Factor.DestinationColor:return goog.webgl.DST_COLOR;case Lemon.BlendMode.Factor.OneMinusDestinationColor:return goog.webgl.ONE_MINUS_DST_COLOR;
case Lemon.BlendMode.Factor.SourceAlpha:return goog.webgl.SRC_ALPHA;case Lemon.BlendMode.Factor.OneMinusSourceAlpha:return goog.webgl.ONE_MINUS_SRC_ALPHA;case Lemon.BlendMode.Factor.DestinationAlpha:return goog.webgl.DST_ALPHA;case Lemon.BlendMode.Factor.OneMinusDestinationAlpha:return goog.webgl.ONE_MINUS_DST_ALPHA}};Lemon.RenderAPI.WebGL.prototype.convertBlendingEquationToConstant=function(a){switch(a){default:case Lemon.BlendMode.Equation.Add:return goog.webgl.FUNC_ADD;case Lemon.BlendMode.Equation.Subtract:return goog.webgl.FUNC_SUBTRACT}};
Lemon.RenderAPI.WebGL.prototype.convertDepthFunctionToConstant=function(a){switch(a){case Lemon.DepthFunction.Never:return goog.webgl.NEVER;case Lemon.DepthFunction.Less:return goog.webgl.LESS;case Lemon.DepthFunction.Equal:return goog.webgl.EQUAL;case Lemon.DepthFunction.LessEqual:return goog.webgl.LEQUAL;case Lemon.DepthFunction.Greater:return goog.webgl.GREATER;case Lemon.DepthFunction.NotEqual:return goog.webgl.NOTEQUAL;case Lemon.DepthFunction.GreaterEqual:return goog.webgl.GEQUAL;case Lemon.DepthFunction.Always:return goog.webgl.ALWAYS;
default:return goog.webgl.LEQUAL}};Lemon.RenderAPI.WebGL.prototype.convertDrawingModeToConstant=function(a){switch(a){default:case Lemon.DrawingMode.Points:return goog.webgl.POINTS;case Lemon.DrawingMode.Lines:return goog.webgl.LINES;case Lemon.DrawingMode.LinesStrip:return goog.webgl.LINE_STRIP;case Lemon.DrawingMode.LinesLoop:return goog.webgl.LINE_LOOP;case Lemon.DrawingMode.Triangles:return goog.webgl.TRIANGLES;case Lemon.DrawingMode.TrianglesStrip:return goog.webgl.TRIANGLE_STRIP;case Lemon.DrawingMode.TrianglesFan:return goog.webgl.TRIANGLE_FAN}};
Lemon.RenderAPI.WebGL.prototype.convertStencilFunctionToConstant=function(a){switch(a){case Lemon.StencilFunction.Never:return goog.webgl.NEVER;case Lemon.StencilFunction.Less:return goog.webgl.LESS;case Lemon.StencilFunction.Equal:return goog.webgl.EQUAL;case Lemon.StencilFunction.LessEqual:return goog.webgl.LEQUAL;case Lemon.StencilFunction.Greater:return goog.webgl.GREATER;case Lemon.StencilFunction.NotEqual:return goog.webgl.NOTEQUAL;case Lemon.StencilFunction.GreaterEqual:return goog.webgl.GEQUAL;
case Lemon.StencilFunction.Always:return goog.webgl.ALWAYS;default:return goog.webgl.LEQUAL}};
Lemon.RenderAPI.WebGL.prototype.convertStencilOperationToConstant=function(a){switch(a){default:case Lemon.StencilOperation.Keep:return goog.webgl.KEEP;case Lemon.StencilOperation.Zero:return goog.webgl.ZERO;case Lemon.StencilOperation.Replace:return goog.webgl.REPLACE;case Lemon.StencilOperation.Increment:return goog.webgl.INCR;case Lemon.StencilOperation.Decrement:return goog.webgl.DECR;case Lemon.StencilOperation.Invert:return goog.webgl.INVERT;case Lemon.StencilOperation.IncrementWrap:return goog.webgl.INCR_WRAP;
case Lemon.StencilOperation.DecrementWrap:return goog.webgl.DECR_WRAP}};Lemon.RenderAPI.WebGL.prototype.convertVertexTypeToConstant=function(a){switch(a){default:case Lemon.VertexElement.Type.Byte:return goog.webgl.BYTE;case Lemon.VertexElement.Type.Float:return goog.webgl.FLOAT;case Lemon.VertexElement.Type.Int:return goog.webgl.INT;case Lemon.VertexElement.Type.Short:return goog.webgl.SHORT}};
Lemon.RenderAPI.WebGL.prototype.convertStreamTypeToConstant=function(a){switch(a){default:case Lemon.VertexElement.StreamType.Static:return goog.webgl.STATIC_DRAW;case Lemon.VertexElement.StreamType.Dynamic:return goog.webgl.DYNAMIC_DRAW;case Lemon.VertexElement.StreamType.Stream:return goog.webgl.STREAM_DRAW}};
Lemon.RenderAPI.WebGL.prototype.convertConstantToShaderTypes=function(a){switch(a){default:case goog.webgl.FLOAT:case goog.webgl.FLOAT_VEC2:case goog.webgl.FLOAT_VEC3:case goog.webgl.FLOAT_VEC4:return Lemon.Type.Float;case goog.webgl.INT:case goog.webgl.INT_VEC2:case goog.webgl.INT_VEC3:case goog.webgl.INT_VEC4:return Lemon.Type.Int;case goog.webgl.BOOL:case goog.webgl.BOOL_VEC2:case goog.webgl.BOOL_VEC3:case goog.webgl.BOOL_VEC4:return Lemon.Type.Bool;case goog.webgl.FLOAT_MAT2:case goog.webgl.FLOAT_MAT3:case goog.webgl.FLOAT_MAT4:return Lemon.Type.Matrix;
case goog.webgl.SAMPLER_2D:return Lemon.Type.Texture2D;case goog.webgl.SAMPLER_CUBE:return Lemon.Type.TextureCube;case goog.webgl.BYTE:return Lemon.Type.Byte;case goog.webgl.UNSIGNED_BYTE:return Lemon.Type.u_Byte;case goog.webgl.SHORT:return Lemon.Type.Short;case goog.webgl.UNSIGNED_SHORT:return Lemon.Type.u_Short;case goog.webgl.UNSIGNED_INT:return Lemon.Type.u_Int}};
Lemon.RenderAPI.WebGL.prototype.convertConstantToShaderCount=function(a){switch(a){default:case goog.webgl.FLOAT:case goog.webgl.INT:case goog.webgl.BOOL:case goog.webgl.SAMPLER_2D:case goog.webgl.SAMPLER_CUBE:case goog.webgl.BYTE:case goog.webgl.UNSIGNED_BYTE:case goog.webgl.SHORT:case goog.webgl.UNSIGNED_SHORT:case goog.webgl.UNSIGNED_INT:return 1;case goog.webgl.FLOAT_VEC2:case goog.webgl.INT_VEC2:case goog.webgl.BOOL_VEC2:case goog.webgl.FLOAT_MAT2:return 2;case goog.webgl.FLOAT_VEC3:case goog.webgl.INT_VEC3:case goog.webgl.BOOL_VEC3:case goog.webgl.FLOAT_MAT3:return 3;
case goog.webgl.FLOAT_VEC4:case goog.webgl.INT_VEC4:case goog.webgl.BOOL_VEC4:case goog.webgl.FLOAT_MAT4:return 4}};Lemon.RenderCanvas=function(a,b,c){Lemon.RenderTarget.call(this);this.renderApi=Lemon.RenderAPI.WebGL.getInstance();this.context.init(Lemon.Private.Context.Type.WebGL,b||{},a)};goog.inherits(Lemon.RenderCanvas,Lemon.RenderTarget);Lemon.RenderCanvas.prototype.clear=function(a){this.removeTasks();this.context.activate();this.renderApi.clear(a)};Lemon.RenderTexture=function(a,b,c,d,e){Lemon.RenderTarget.call(this);this.renderApi=Lemon.RenderAPI.WebGL.getInstance();this.framebuffer=this.renderApi.createFrameBuffer();this.textures=[];this.init(a,b,c,d,e)};goog.inherits(Lemon.RenderTexture,Lemon.RenderTarget);
Lemon.RenderTexture.prototype.init=function(a,b,c,d,e){for(var f=0;f<c;f++){var g=new Lemon.Image;g.create(a,b,null);var h=new Lemon.Texture;h.setRepeated(!1);h.setSmooth(!0);h.useMipmap(!1);h.loadFromImage(g);this.textures.push(h)}this.renderApi.initFrameBuffer(this.framebuffer,this.textures,d,e)};Lemon.RenderTexture.prototype.clear=function(a){this.removeTasks();this.begin();this.renderApi.clear(a)};Lemon.RenderTexture.prototype.begin=function(){this.renderApi.bindFrameBuffer(this.framebuffer)};
Lemon.RenderTexture.prototype.display=function(){Lemon.RenderTarget.prototype.display.call(this);this.renderApi.bindFrameBuffer(-1)};Lemon.RenderTexture.prototype.getTextures=function(){return this.textures};Lemon.PostEffect=function(a){this.renderApi=Lemon.RenderAPI.WebGL.getInstance();this.renderTexture=null;this.sprite=new Lemon.Sprite;this.sprite.setCustomProgram(a)};Lemon.PostEffect.prototype.init=function(a,b,c,d){this.renderTexture=new Lemon.RenderTexture(a,b,1,c||!0,d||!1);this.sprite.setSize(1,1);this.sprite.setTexture(this.renderTexture.getTextures()[0]);this.sprite.setTextureRect(0,0,a,b)};
Lemon.PostEffect.prototype.begin=function(a){this.renderTexture&&this.renderTexture.clear(a||new Lemon.Color(30,30,30))};Lemon.PostEffect.prototype.end=function(){this.renderTexture&&(this.renderTexture.display(),Lemon.SpriteCommand.draw(this.renderApi,this.sprite))};Lemon.PostEffect.prototype.render=function(a,b){this.renderTexture.render(a,b)};Lemon.PostEffect.prototype.setProgram=function(a){this.sprite.setCustomProgram(a)};
Lemon.PostEffect.prototype.setEffectValue=function(a,b,c,d){this.renderApi.setUniform(this.sprite.getCustomProgram(),a,b,c,d)};
